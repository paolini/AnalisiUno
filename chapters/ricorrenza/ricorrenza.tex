\section{equazioni ricorsive autonome del primo ordine}

\begin{example}[algoritmo di Erone]\label{ex_Erone}
\index{Erone!algoritmo di}%
\index{algoritmo!di Erone}%
\index{algoritmo!calcolo della radice $n$-esima}%
\index{radice $n$-esima!algoritmo di Erone}%
  Fissato un numero reale $p>1$ consideriamo la successione definita
  per
ricorrenza da
\[
\begin{cases}
  a_0 = p\\
  a_{n+1} = \frac{a_n + p/a_n}{2}.
\end{cases}
\]
Si dimostri che $a_n \to \sqrt p$.
\end{example}
Osserviamo, ad esempio, che per $p=2$ i
primi termini della successione sono:
\begin{align*}
a_0 &= 2, \\
a_1 &= \frac{2+2/2}{2} = 3/2 = 1.5, \\
a_2 &= \frac{3/2 + 2/(3/2)}{2} = 17/12 \approx 1.4166666, \\
a_3 &= \frac{17/12 + 2/(17/12)}{2} = 577 / 408 \approx 1.4142157,\\
\vdots
\end{align*}
che effettivamente \emph{sembrano} avvicinarsi molto al numero
\[
\sqrt 2\approx 1.4142135.
\]

\begin{proof}
\emph{Passo 1.} Dimostriamo per induzione che $a_n>0$ per ogni $n\in \NN$.
Infatti per $n=0$ osserviamo che $a_0=p>0$ mentre se supponiamo che
$a_n>0$ otteniamo che $a_{n+1} = \frac{a_n + \frac p {a_n}}2$ è positivo in quanto
è la metà della somma di due quantità positive. Quindi, applicando il
principio di induzione, possiamo concludere che $a_n>0$ per ogni $n$.

Abbiamo in effetti identificato un insieme $A=\ENCLOSE{x\colon x>0} = (0,
+\infty)$ tale che la funzione $f(x) = \frac{x + \frac p x}{2}$ è definita
su $A$ e, contemporaneamente, ha valori in $A$.
Quindi questo passaggio è fondamentale anche solo per
garantire che la successione $a_n$ sia ben definita.

\emph{Passo 2.} Dimostriamo che la successione $a_n$ è decrescente.
Per fare questo osserviamo che essere decrescente significa:
$ a_{n+1} \le a_n$
e cioé
\[
\frac{a_n + \frac p {a_n}}{2} \le a_n
\]
ovvero (moltiplicando ambo i lati per $a_n>0$)
\[
a_n^2 + p \le 2 a_n^2
\]
che è equivalente a $a_n^2 - p \ge 0$. E, in effetti, questa
disuguaglianza è sempre vera in quanto per $n=1$ si riduce a $a_1^2 - p
= p^2 - p \ge 0$ che è soddisfatta nel caso $p>1$. Mentre
\begin{align*}
a_{n+1}^2 - p & = \left(\frac{a_n+\frac p{a_n}}{2}\right)^2 - p
= \frac{a_n^4 + 2 p a_n^2 + p^2 - 4 p a_n^2}{4 a_n^2} \\
& = \frac{a_n^4 - 2 p a_n^2 + p^2}{4 a_n^2}
 = \frac{\left(a_n^2 - p\right)^2}{4a_n^2} \ge 0.
\end{align*}
Dunque $a_{n+1}^2 \ge p$ per ogni $n\in \NN$ e di conseguenza $a_n$ è
decrescente e inoltre $a_n > \sqrt p$.

\emph{Passo 3.}
Visto che $a_n$ è una successione decrescente,
per il teorema sulle successioni monotòne possiamo
affermare che $a_n$ ammette limite, e cioé: $a_n \to \ell$ con $\ell
\in [-\infty, +\infty]$. Possiamo immediatamente escludere
$\ell=+\infty$ in quanto la successione è decrescente, e possiamo
anche escludere $\ell<\sqrt{p}$ in quanto sappiamo che $a_n > \sqrt{p}$ e quindi
(per il teorema della permanenza del segno) $\ell \ge \sqrt p$.
Inoltre
\[
  a_{n+1} = \frac{a_n + \frac p{a_n}}{2} \to \frac{\ell + \frac p \ell}{2}.
\]
Ma sappiamo che se $a_n\to \ell$ anche $a_{n+1}\to \ell$ (visto che
$a_{n+1}$ è una sottosuccessione di $a_n$) e quindi (per l'unicità del
limite)
\begin{equation}\label{ex_1_fixed}
  \ell = \frac{\ell + \frac p \ell}{2}
\end{equation}
da cui si ricava $\ell^2 = p$ ovvero (essendo $\ell\ge 0$) concludiamo
$a_n \to \ell =
\sqrt p$.
\end{proof}

Cominciamo ora a definire una terminologia e a fissare alcuni
risultati generali che ci serviranno per trovare alcune proprietà
delle successioni definite da~ \eqref{eq1}.

\begin{definition}[punto fisso]
\mymark{**}%
  Diremo che $x$ è un \emph{punto fisso}%
\mymargin{punto fisso}\index{punto!fisso}
  per la funzione $f$ se vale
  \[
    f(x) = x.
  \]
\end{definition}
Osserviamo che se $\alpha$ è un punto fisso per $f$ la successione costante
$a_n=\alpha$ soddisfa l'equazione $a_{n+1} = f(a_n)$. Inoltre se
$a_{n+1} = f(a_n)$, se $a_n$ converge ad un limite $\ell$ e se
$f$ è continua in $\ell$ allora
\[
a_{n+1} = f(a_n) \to f(\ell)
\]
ma visto che $a_{n+1}$ ha lo stesso limite di $a_n$ si trova che
$f(\ell)=\ell$ ovvero il limite della successione è un punto fisso.

Nell'esempio precedente la funzione $f(x) = \frac{x+\frac p x}2$ ha come punti
fissi $\sqrt{p}$ e $-\sqrt{p}$ e l'equazione~\eqref{ex_1_fixed} non è
altro che $f(x)=x$. E in effetti abbiamo mostrato che la successione
$a_n$ converge proprio ad un punto fisso.

\begin{definition}[insieme invariante]
\mymark{**}%
  Un insieme $A$ si dice essere \emph{invariante}
  \mymargin{insieme invariante}%
\index{insieme!invariante}%
  per $f$ se
  $f(A)\subseteq A$
  (ovvero: per ogni $x\in A$ si ha $f(x)\in A$).
\end{definition}

Osserviamo che se $A$ è un insieme invariante e $a_0\in A$ allora la
successione definita da $a_{n+1}=f(a_n)$ assume sempre valori in $A$.

Nell'esercizio~\ref{ex_Erone} abbiamo dimostrato che gli intervalli
$(0,+\infty)$ e $(\sqrt{p},+\infty)$ sono invarianti.

\begin{theorem}\label{th_1}
\mymark{*}%
  Sia $A\subset \RR$ un insieme invariante per $f$ e sia $a_n$ una
  successione con $a_0 \in A$ e $a_{n+1}=f(a_n)$.

  Se per ogni $x\in A$
  vale $f(x) \ge x$
  \mymargin{$f(x)\ge x$}%
  allora la successione $a_n$ è crescente.

  Se per ogni $x\in A$ vale $f(x) \le x$
  \mymargin{$f(x)\le x$}%
  allora la successione $a_n$ è decrescente.
\end{theorem}
\begin{proof}
\mymark{*}%
  In effetti se $f(x) \ge x$ si ha per ogni $n\in \NN$
  \[
  a_{n+1} = f(a_n) \ge a_n
  \]
e quindi la successione $a_n$ è crescente. Mentre se $f(x) \le x$ si ha
  \[
  a_{n+1} = f(a_n) \le a_n
  \]
e la successione è decrescente.
\end{proof}

\begin{exercise}
Al variare di $\alpha \in \RR$
determinare il limite della successione $a_n$ definita per ricorrenza dalle
equazioni:
\[
\begin{cases}
 a_0 = \alpha \\
 a_{n+1} = a_n - a_n^2.
\end{cases}
\]
\end{exercise}

\begin{theorem}
\mymark{**}%
  Sia $A\subset \RR$ un insieme invariante per $f$ e sia $a_n$ una successione
  con $a_0\in A$ e $a_{n+1} = f(a_n)$. Se $f$ è crescente
  \mymargin{$f$ crescente}%
  su $A$ allora $a_n$
  è monotòna.
\end{theorem}
\begin{proof}
\mymark{**}%
  Osserviamo che se $f$ è crescente allora
  \begin{align*}
    a_{n+1} \ge a_n \Rightarrow f(a_{n+1}) \ge f(a_n) \Rightarrow
    a_{n+2} \ge a_{n+1}\\
    a_{n+1} \le a_n \Rightarrow f(a_{n+1}) \le f(a_n) \Rightarrow a_{n+2} \le a_{n+1}.
  \end{align*}
  Dunque se per i primi due termini si ha $a_1 \ge a_0$ allora, per
  induzione, si ha $a_{n+1} \ge a_n$ per ogni $n$ e quindi la
  successione è crescente. Se invece $a_1 \le a_0$ si dimostra per
  induzione che $a_{n+1} \le a_n$ per ogni $n$ e quindi la successione
  è decrescente.
\end{proof}

\begin{theorem}\label{th_decr}%
\mymark{**}%
  Sia $A\subset \RR$ un insieme invariante per $f$ e sia $a_n$ una successione
  con $a_1\in A$ e $a_{n+1} = f(a_n)$. Se $f$ è decrescente
  \mymargin{$f$ decrescente}%
  su $A$
  allora le due successioni $a_{2n}$ (termini di indice pari) e
  $a_{2n+1}$ (termini di indice dispari) sono monotòne.
\end{theorem}
\begin{proof}
\mymark{**}%
  Osserviamo che
  \begin{align*}
    a_{2n+2} &= f(a_{2n+1}) = f(f(a_{2n})) = (f\circ f)(a_{2n})\\
    a_{2n+3} &= f(a_{2n+2}) = f(f(a_{2n+1})) = (f\circ f)(a_{2n+1})
  \end{align*}
cioé le sottosuccessioni dei termini di indice pari e di indice
dispari soddisfano una relazione di ricorrenza tramite la funzione
$f\circ f$ (invece che $f$).

Osserviamo anche che se $f$ è decrescente allora $f\circ f$ è
crescente. Infatti:
\[
x \le y \Rightarrow f(x) \ge f(y) \Rightarrow f(f(x)) \le f(f(y)).
\]

Dunque possiamo applicare il teorema precedente e ottenere che le due
sottosuccessioni sono entrambe monotòne.
\end{proof}

Utilizziamo la terminologia e i risultati precedenti nei seguenti
esercizi.

\begin{exercise}[Fibonacci]\label{ex_fibonacci}%
\index{Fibonacci!successione di}%
\index{successione!di Fibonacci}%
  Si consideri il rapporto $a_n = \frac{F_{n+1}}{F_n}$ di due termini
  successivi della successione di Fibonacci: $F_0=1$, $F_1=1$,
  $F_{n+2} = F_{n+1} + F_n$. Determinare il limite di $a_n$.
\end{exercise}

\begin{proof}[Soluzione]
  La successione $a_n$ soddisfa la relazione:
  \[
   a_{n+1} = \frac{F_{n+2}}{F_{n+1}} = \frac{F_{n+1}+F_n}{F_{n+1}} = 1
   + \frac{F_n}{F_{n+1}} = 1 + \frac{1}{a_n}.
   \]
   Inoltre $a_0=F_2 / F_1 = 1$. Dunque la successione $a_n$ soddisfa
   le seguenti proprietà:
   \[
   \begin{cases}
     a_0 = 1 \\
     a_{n+1} = 1 + \frac{1}{a_n}.
   \end{cases}
   \]

   Osserviamo che l'intervallo $A=(0,+\infty)$ è invariante per la
   funzione $f(x) = 1+1/x$. Infatti
   se $x\in A$ allora $x>0$ ma anche $f(x) = 1+1/x$ lo è.
   Su tale intervallo, inoltre, la funzione $f$ è decrescente. Infatti
   \[
   0 < x \le y \Rightarrow \frac 1 x \ge \frac 1 y \Rightarrow 1+\frac
   1 x \ge 1 + \frac 1 y
   \Rightarrow f(x) \ge f(y).
   \]
   Visto che $a_0 = 1 \in A$, $A$ invariante, $f$ decrescente su $A$,
   il Teorema~\ref{th_decr} ci dice che le due successioni $a_{2n}$ e
   $a_{2n+1}$ sono monotone e quindi ammettono limite: $a_{2n}\to
   \ell$, $a_{2n+1} \to \ell'$ con $\ell,\ell' \in [0,+\infty]$.

   Se $\ell$ è finito si ha:
   \[
   a_{2n+1} = f(a_{2n}) = 1+ \frac{1}{a_{2n}} \to 1 + \frac{1}{\ell}
   \]
   e quindi dato che $a_{2n+1}\to \ell'$ si ha $\ell' = 1 + 1/\ell$.
   Inoltre
   \begin{align*}
   a_{2n+2} &= f(a_{2n+1}) = 1 + \frac{1}{a_{2n+1}} \to 1 +
   \frac{1}{\ell'}
   = 1 + \frac{1}{1+\frac{1}{\ell}} \\
   & = 1 + \frac{\ell}{\ell+1}
   = \frac{2\ell +1}{\ell +1}
   \end{align*}
   da cui, visto che $a_{2n+2}\to \ell$,
   \[
   \ell = \frac{2\ell +1 }{\ell +1}.
   \]
   Moltiplicando ambo i membri per $\ell+1$ si ottiene
   \[
    \ell^2 + \ell = 2\ell + 1
    \]
    ovvero $\ell^2 - \ell -1 =0$ da cui, utilizzando la formula
    risolutiva delle equazioni di secondo grado, e ricordando che
    $\ell \ge 0$, si trova:
    \[
    \ell = \frac{1 + \sqrt{5}}{2}.
    \]
    Ma anche
    \begin{align*}
    \ell' &= 1 + \frac 1 \ell = \frac{\ell + 1}{\ell} = \frac{3+\sqrt
      5}{1 + \sqrt 5} = \frac{(3+\sqrt 5)(1-\sqrt 5)}{1-5} \\
     &= \frac{3-2\sqrt 5-5}{-4} = \frac{2+2\sqrt 5}{4} = \frac{1+\sqrt
       5}{2} = \ell.
    \end{align*}
    Dunque entrambe le sottosuccessioni dei termini di indice pari e
    di indice dispari convergono allo stesso valore $\ell$ e quindi
    l'intera successione ci converge: $a_n\to (1+\sqrt 5)/2$.

    Il caso $\ell=+\infty$ si può escludere in quanto ripetendo il
    ragionamento fatto sopra si otterrebbe $\ell' = 1$ da cui:
    $\ell = 1 + 1/\ell' = 2$ che è una contraddizione.
\end{proof}
\newsavebox{\qrexfibonacci}\sbox{\qrexfibonacci}{%
\myqrshortdoclink{fibonacci}{Diagramma a ragnatela relativo all'esercizio \getrefnumber{ex_fibonacci}}}
%
\begin{figure}
  \begin{center}
    \includegraphics[width=\textwidth]{fig_fibonacci.png}
  \end{center}
  \caption{Diagramma a ragnatela relativo
    all'esercizio~\ref{ex_fibonacci}:
    sul rapporto dei termini successivi della successione di Fibonacci.\\\\
    \usebox{\qrexfibonacci}%
    }
  \label{fig_fibonacci}
\end{figure}

Un metodo grafico per visualizzare l'andamento dei termini della
successione definita da \eqref{eq1} è il \emph{diagramma a
  ragnatela}. Si disegna la curva $y=f(x)$ su un piano
cartesiano. Partendo dal punto di coordinate $(\alpha, 0)=(a_0, 0)$ si procede
lungo una retta verticale fino a raggiungere il grafico della funzione
nel punto $(a_0, f(a_0)) = (a_0, a_1)$.
Dopodiché si procede in
orizzontale fino ad incontrare la retta $y=x$ nel punto $(a_1,a_1)$ e
si ripete il procedimento in modo che le coordinate $x$ (ma anche le $y$)
dei vertici della spezzata mi danno la successione $a_0, a_1, a_2,
\dots$. Ad esempio il diagramma a ragnatela corrispondente
all'esercizio~\ref{ex_fibonacci} è rappresentato in
Figura~\ref{fig_fibonacci}.

\begin{exercise}\label{ex_3}
  Si consideri la successione definita per ricorrenza
  \[
  \begin{cases}
    a_0 = 0\\
    a_{n+1} = 1 + a_n^2.
  \end{cases}
  \]
  Determinare il limite della successione.
\end{exercise}
\newsavebox{\qrextre}\sbox{\qrextre}{%
\myqrshortdoclink{ex3}{Diagramma a ragnatela relativo all'esercizio \getrefnumber{ex_3}}}
\begin{figure}
  \begin{center}
    \includegraphics[width=\textwidth]{fig_ex_3.png}
  \end{center}
  \caption{Diagramma a ragnatela relativo
    all'esercizio~\ref{ex_3}.
    \ifwidemargin\\\\\fi%
    \usebox{\qrextre}}
  \label{fig_ex_3}
\end{figure}

\begin{proof}[Soluzione]
  L'equazione ricorsiva è $a_{n+1}=f(a_n)$ se poniamo $f(x) = 1+x^2$.
  E' facile verificare che per ogni $x$ si ha $f(x) > x$ e quindi, per
  il Teorema~\ref{th_1} otteniamo che la successione $a_n$ è
  crescente. Dunque ammette limite: $a_n \to \ell$. Se il limite fosse
  finito si avrebbe
  \[
  a_{n+1} = 1 + a_n^2 \to 1 + \ell^2
  \]
  e quindi, visto che $a_{n+1}\to \ell$, si avrebbe $\ell = 1 +
  \ell^2$ (cioè $\ell$ dovrebbe essere un punto fisso di $f$). Questa
  equazione abbiamo già osservato che non ha soluzioni ($x^2 + 1 > x$)
  e quindi $\ell$ non è finito. Visto che la successione $a_n$ è
  crescente possiamo escludere che sia $\ell=-\infty$ e quindi l'unica
  possibilità che rimane è che $a_n \to +\infty$.
\end{proof}

\newsavebox{\qrexquattro}\sbox{\qrexquattro}{%
\myqrshortdoclink{ex4}{Diagramma a ragnatela relativo all'esercizio \getrefnumber{ex_4}}}
\begin{figure}
  \begin{center}
  \includegraphics[width=\textwidth]{fig_ex_4.png}
  \end{center}
  \caption{Diagramma a ragnatela relativo
    all'esercizio~\ref{ex_4}.
    \ifwidemargin\\\\\fi%
    \usebox{\qrexquattro}
    }
  \label{fig_ex_4}
\end{figure}

\begin{exercise}\label{ex_4}
  Si consideri la successione definita per ricorrenza
  \[
  \begin{cases}
    a_0 = 1\\
    a_{n+1} =4-\frac 1 {a_n}.
  \end{cases}
  \]
  Determinare il limite della successione.
\end{exercise}

\begin{proof}[Soluzione]
  Si mostra che sull'intervallo $A=(2-\sqrt 3, 2+\sqrt 3)$
  vale $f(x)>x$, che gli estremi di $A$ sono punti fissi
  e inoltre che la funzione $f$ è crescente (lo è su tutto $(0,+\infty)$).
  Di conseguenza è facile verificare che $A$ è invariante, in quanto si ha
  \begin{align*}
  2-\sqrt 3 < x < 2+\sqrt 3 &\Rightarrow
  f(2-\sqrt 3) < f(x) < f(2+\sqrt 3)\\
  &\Rightarrow
  2-\sqrt 3 < f(x) < 2+\sqrt 3.
  \end{align*}

  Inoltre se $a_0 \in A$ allora per ogni $n\in\NN$ si ha $a_n\in A$ ed essendo
  $f(x)>x$ la successione sarà crescente. Dunque ammette
  limite: $a_n \to \ell \in [2-\sqrt 3,2+\sqrt 3]$, $\ell \ge a_0$.
  Ma allora
  \[
  a_{n+1} = 4-\frac 1 {a_n} \to 4 - \frac 1 \ell = f(\ell)
  \]
  e visto che $a_{n+1}$ ha lo stesso limite di $a_n$ si ha $\ell =
  f(\ell)$ le cui uniche soluzioni sono $2\pm \sqrt 3$. Ma $2-\sqrt 3$
  va scartata in quanto $\ell\ge a_0 > 2-\sqrt 3$ e quindi rimane
  $a_n \to \ell = 2+\sqrt 3$.
\end{proof}

\newsavebox{\qrexcinque}\sbox{\qrexcinque}{%
\myqrshortdoclink{ex5}{Diagramma a ragnatela relativo all'esercizio \getrefnumber{ex_5}}}
\begin{figure}
 \begin{center}
    \includegraphics[width=\textwidth]{fig_ex_5.png}
  \end{center}
  \caption{Diagramma a ragnatela relativo
    all'esercizio~\ref{ex_5}.
    \ifwidemargin\\\\\fi%
    \usebox{\qrexcinque}}
  \label{fig_ex_5}
\end{figure}

\begin{exercise}\label{ex_5}
  Si consideri la successione definita per ricorrenza
  \[
  \begin{cases}
    a_0 = \frac 1 2\\
    a_{n+1} = 1 - \frac{1}{a_n}
  \end{cases}
  \]
  Determinare, se esiste, il limite della successione.
\end{exercise}

\begin{proof}[Soluzione]
  Osserviamo che:
  \begin{align*}
    a_0 &= \frac 1 2 \\
    a_1 &= 1 - \frac{1}{1/2} = -1\\
    a_2 &= 1 - \frac{1}{-1} = 2\\
    a_3 &= 1 - \frac{1}{2} = \frac 1 2 = a_0
  \end{align*}
  Essendo $a_3 = a_0$ la successione si ripete e, (per induzione) si
  dimostra che $a_{3n+k} = a_k$. Dunque si ha
  \begin{align*}
    a_{3n} &= a_0 = \frac 1 2\\
    a_{3n+1} &= a_1 = -1\\
    a_{3n+2} &= a_2 = 2
  \end{align*}
  e la successione $a_n$ non ammette limite.
\end{proof}

\newsavebox{\qrexsei}\sbox{\qrexsei}{%
\myqrshortdoclink{ex6}{Diagramma a ragnatela relativo all'esercizio \getrefnumber{ex_6}}}
\begin{figure}
  \begin{center}
    \includegraphics[width=\textwidth]{fig_ex_6.png}
  \end{center}
  \caption{Diagramma a ragnatela relativo
    all'esercizio~\ref{ex_6}.
    \ifwidemargin\\\\\fi%
    \usebox{\qrexsei}}
  \label{fig_ex_6}
\end{figure}

\begin{exercise}\label{ex_6}
  Si consideri la successione definita per ricorrenza
  \[
  \begin{cases}
    a_0 = 0\\
    a_{n+1} = \frac{5-a_n^2}{4}.
  \end{cases}
  \]
  Determinare il limite della successione.
\end{exercise}

\begin{proof}[Soluzione]
Si ha $a_{n+1} = f(a_n)$ se scegliamo $f(x) = (5-x^2)/4$. Osserviamo
che la funzione $f$ è decrescente per $x \ge 0$ (infatti $0 \le x_1 <
x_2$ implica $x_1^2 < x_2^2$ da cui $-x_1^2 > -x_2^2$ e quindi $f(x_1)
> f(x_2)$). Osserviamo inoltre che
\begin{align*}
a_0 &= 0\\
a_1 &= f(a_1) = \frac 5 4.\\
a_2 &= f\enclose{\frac 5 4} = \frac{5-25/16}{4} = \frac{55}{64}
\end{align*}
Vogliamo dimostrare che l'intervallo $A=[0,5/4]$ è invariante. Visto
che $f$ è decrescente su tale intervallo, si ha:
\begin{align*}
0 \le x \le \frac 5 4 &\Rightarrow f(0) \ge f(x) \ge f(5/4)\\
&\Rightarrow \frac 5 4 \ge f(x) \ge \frac{55}{64} \ge 0\\
&\Rightarrow 0 \le f(x) \le \frac 5 4
\end{align*}
cioè $x\in A \Rightarrow f(x)\in A$, che è quanto volevamo dimostrare.

Per il Teorema~\ref{th_decr} sappiamo dunque che $a_{2n} \to \ell$ e
$a_{2n+1} \to \ell'$. Entrambi i limiti sono finiti in quanto essendo
$a_n \in A$ per ogni $n$, si ha $\ell, \ell' \in \bar A = A$.
Dunque, come al solito, osserviamo che si ha:
\begin{align*}
  a_{2n+1} &= f(a_n) \to f(\ell)  \\
  a_{2n+2} &= f(a_{n+1}) \to f(\ell')
\end{align*}
ma sapendo che $a_{2n+1}\to \ell'$ e $a_{2n+2}\to \ell$ otteniamo il
seguente sistema:
\[
\begin{cases}
  \ell' = f(\ell)\\
  \ell = f(\ell')
\end{cases}
\]
da cui si ottiene $f(f(\ell))=\ell$ e $f(f(\ell'))=\ell'$. Dunque
vogliamo scrivere e risolvere l'equazione $f(f(x))=x$:
\[
\frac{5-\left(\frac{5-x^2}{4}\right)^2}{4} = x
\]
cioè
\[
5 - \frac{25 - 10x^2 + x^4}{16} = 4x
\]
ovvero
\[
x^4 - 10 x^2 + 64 x - 55 = 0.
\]

Come facciamo a risolvere una equazione di quarto grado?
In questo frangente dobbiamo fare una osservazione di carattere
generale che ci sarà di grande aiuto.
Osserviamo che se $x$ è una soluzione di $f(x)=x$ allora $x$
è anche soluzione di $f(f(x)) = x$ in quanto in tal caso si ha
$f(f(x))=f(x)=x$.
Ma l'equazione $f(x) = x$ è una equazione di secondo grado, che quindi
possiamo facilmente risolvere:
\begin{gather*}
  \frac{5-x^2}{4} = x \\
  x^2 + 4x - 5 = 0 \\
  x_{12} = -2 \pm \sqrt{4 + 5} = -2 \pm 3.
\end{gather*}

Dunque abbiamo trovato due zeri del polinomio di quarto grado e
tale polinomio deve essere quindi divisibile per
\[
 x^2 + 4x - 5 = (x-1)(x+5).
\]
Eseguiamo la divisione tra polinomi:
\begin{align*}
\frac{x^4 - 10 x^2 + 64 x - 55}{x^2 + 4x - 5}
&= x^2 + \frac{x^4 - 10 x^2 + 64x - 55 - x^2 (x^2 + 4x - 5)}{x^2+4x-5}\\
&= x^2 + \frac{-4x^3 - 5 x^2 + 64 x - 55}{x^2+4x-5}\\
&= x^2 - 4x + \frac{-4x^3 - 5x^2 - 64 x - 55 + 4x(x^2+4x-5)}{x^2+4x-5}
\\
&= x^2 - 4x + \frac{11 x^2 + 44 x - 55}{x^2 + 4x -5}\\
&= x^2 - 4x + 11.
\end{align*}
Come previsto la divisione non ha resto. Possiamo quindi completare la
scomposizione cercando gli zeri del polinomio $x^2-4x+11$ che però, da
un rapido controllo, non ha soluzioni reali.

Dunque in questo caso i punti fissi di $f$ coincidono con i punti
fissi di $f\circ f$ e dunque i due limiti $\ell, \ell'$ devono essere
elementi dell'insieme dei punti fissi: $\ENCLOSE{1, -5}$. D'altra parte $-5$
deve essere escluso in quanto i limiti stanno entrambi nella chiusura
dell'insieme invariante, che non comprende numeri negativi.

Concludiamo quindi che $\ell = \ell' = 1$ e dunque l'intera
successione ha limite: $a_n \to 1$.
\end{proof}

\begin{exercise}\label{ex_7}
  %% a_n <- (a_n + 2)/4
  Si consideri la successione definita per ricorrenza
  \[
  \begin{cases}
    a_0 = \alpha\\
    a_{n+1} = 4 a_n (1-a_n) % 2- a_n^2.
  \end{cases}
  \]
  Determinare il limite della successione nei casi: 
  $\alpha=-1$, 
  $\alpha=2$ e 
  $\alpha=1/42$.
\end{exercise}


\newsavebox{\qrexsette}\sbox{\qrexsette}{%
\myqrshortdoclink{ex7b}{Diagramma a ragnatela relativo all'esercizio \getrefnumber{ex_7}}}
\begin{figure}
   \begin{center}
    \includegraphics[width=0.5\textwidth]{fig_ex_7.png}
  \end{center}
  \caption{Diagramma a ragnatela relativo
    all'esercizio~\ref{ex_7}.
    \ifwidemargin\\\\\fi%
    \usebox{\qrexsette}}
  \label{fig_ex_7}
\end{figure}

\begin{proof}[Soluzione]
  Abbiamo $a_{n+1} = f(a_n)$ con $f(x) = 4x(1-x)$. 
  Determiniamo i punti
  fissi di $f$:
  \[
  4x(1-x)= x, \qquad 4 x^2 - 3x = 0
  \]
  che ha come soluzioni $x_1=0$ e $x_2=\frac 3 4$. 
  Tenendo conto anche dei segni si può
  osservare che all'interno delle due soluzioni si ha $f(x)>x$ mentre
  all'esterno si ha $f(x)<x$.

  Osserviamo inoltre che $f(x)$ è crescente per
  $x\le \frac 1 2$ e decrescente per $x\ge \frac 1 2$.

  Caso $\alpha=-1$. In questo caso consideriamo l'intervallo
  $A=(-\infty, 0)$. Visto che $f$ è crescente su questo intervallo,
  e visto che $0$ è un punto fisso si ha:
  \[
  x < 0 \Rightarrow f(x) < f(0) \Rightarrow f(x) < 0
  \]
  che significa che $A$ è un intervallo invariante.

  Su questo intervallo si ha $f(x)<x$ e quindi $a_n$ è decrescente e
  di conseguenza ammette limite $a_n\to \ell$. Il limite può essere
  finito oppure $-\infty$. Ma se fosse finito allora avremmo
  \[
  a_{n+1} = 4 a_n (1-a_n) \to 4 \ell (1-\ell)
  \]
  e siccome $a_{n+1}\to \ell$ avremmo che $\ell$
  è un punto fisso di $f$. 
  Ma visto che $\ell \le a_0 = \alpha < 0$
  otteniamo un assurdo.

  Dunque l'unica possibilità è che $a_n \to -\infty$. Questo
  stesso ragionamento vale per ogni $\alpha<0$.

  Caso $\alpha=2$. In questo caso si ha:
  \begin{align*}
    a_0 &= \alpha = 2\\
    a_1 &= f(a_0) = 4\cdot 2\cdot (1-2) = -8.
  \end{align*}
  quindi $a_1 \in A$ (l'intervallo invariante del punto precedente) e
  dall'indice $2$ in poi ci si riconduce quindi ai risultati
  precedenti. Dunque anche in questo caso $a_n \to -\infty$.

  Caso $\alpha = \frac 1{42}$. Questo caso è decisamente più complesso dei
  precedenti. Prendiamo l'insieme $A_2 = [0, 1]$: vogliamo dimostrare
  che è un insieme invariante. Nell'intervallo $\closeinterval{0}{\frac 1 2}$ la funzione è
  crescente e quindi ha minimo in $0$ dove vale $f(0)=0$ ed ha
  massimo in $\frac 1 2$ dove assume il valore $f(1/2) = 1$. Nell'intervallo
  $\closeinterval{\frac 1 2}{1}$ la funzione è decrescente e, di nuovo, ha massimo $f(1/2)=1$ e
  minimo $f(1)=0$. Dunque per ogni $x\in [0,1]$ si ha $f(x) \in
  [0,1]$ cioè, come volevamo dimostrare, $A_2$ è invariante.

  Dunque visto che $a_0 = \alpha \in A_2$ scopriamo che per ogni $n$
  si ha $a_n \in [0,1]$. Supponiamo ora che la successione abbia
  limite: $a_n \to \ell$. In tal caso, passando al limite
  nell'equazione $a_{n+1} = f(a_n)$ otteniamo, come al solito, che il
  limite dovrebbe essere un punto fisso di $f$: o $\ell=0$ oppure
  $\ell=\frac 3 4$. Cercheremo ora di dimostrare che questo è assurdo. Ci sono
  due possibilità che dobbiamo escludere. La prima è che la
  successione tenda al punto fisso $\ell$ senza mai uguagliarlo. La
  seconda è che per un certo $n_0$ si abbia $a_n = \ell$ per $n=n_0$ e
  quindi per ogni $n\ge n_0$.

  Supponiamo di essere nel primo caso e supponiamo che $\ell = 0$. In
  tal caso, per il teorema della permanenza del segno la successione
  deve, da un certo indice in poi, stare nell'intervallo $\closeinterval{0}{\frac 1 2}$. Ma
  in tale intervallo si ha $f(x)>x$ e quindi la successione sarebbe,
  da un certo indice in poi, crescente. Ma visto che $a_n \ge 0$ per
  ogni $n$, non è possibile che la successione converga, crescendo, a
  $0$.

  Supponiamo allora di essere nel primo caso (la successione è sempre
  diversa dai due punti fissi) e supponiamo che $\ell = \frac 3 4$. In
  questo caso da un certo indice in poi la successione deve stare
  nell'intervallo $\closeinterval{\frac 1 2}{1}$ (altrimenti non potrebbe convergere a
  $\frac 3 4$). In tale intervallo la funzione $f$ è decrescente e quindi
  le sottosuccessioni dei termini pari e dei termini dispari sono
  entrambe monotòne. Si potrebbe cercare di studiare le successioni dei
  termini pari $a_{2n}$ e dispari $a_{2n+1}$ che soddisfano una relazione di ricorrenza
  con la funzione $f\circ f$ al posto di $f$ e osservare che la successione
  che si trova a sinistra del punto fisso dovrebbe decrescere e quella che si trova a
  destra dovrebbe crescere (e questo sarebbe assurdo). Un metodo forse più
  rapido che non richiede lo studio della funzione composta è invece il seguente.
  L'idea è di osservare che $f$ tende ad aumentare le distanze quando ci si trova
  nei paraggi del punto $1$. Se per assurdo $a_n\to \frac 3 4$ allora definitivamente
  si dovrà avere $\abs{a_n-\frac 3 4}< 1/8$. Ma allora si osserva che:
  \[
    \abs{a_{n+1}-\frac 3 4}
    = \abs{4a_n(1-a_n)-\frac 3 4}
    = \abs{\frac 3 4 - 4a_n + 4a_n^2}
    = \abs{a_n-\frac 3 4}\abs{4a_n -1}
    \ge 4\abs{a_n-\frac 3 4}
  \]
  in quanto se $\abs{a_n-\frac 3 4}<1/8$ allora (per la disuguaglianza triangolare inversa)
  $\abs{4a_n-1}\ge 4$. Questo è assurdo perché significa che $\abs{a_n -\frac 3 4}\to +\infty$
  (per il criterio del rapporto) quando invece dovrebbe essere $\abs{a_n-\frac 3 4}\to 0$.

  \textbf{Nota.} Vedremo nei prossimi teoremi che
  se la derivata di $f$ è in valore assoluto minore di
  $1$ allora il punto fisso sarà stabile (o attrattivo) cioè partendo
  da un punto sufficientemente vicino si convergerà necessariamente al
  punto fisso. Se invece la derivata è in valore assoluto maggiore di
  $1$ il punto fisso sarà instabile (o repulsivo). Cioè, a parte la
  successione costante che assume il valore esatto del punto fisso,
  non è
  possibile che una successione converga al punto fisso.

  Rimane da considerare la possibilità che la successione assuma da un
  certo punto in poi il valore esatto di un punto fisso. Supponiamo ad
  esempio che per un certo $n$ si abbia $a_n=\frac 3 4$. Allora si deve avere
  \[
  \frac 3 4 = a_n = 4\cdot a_{n-1} \cdot (1-a_{n-1})
  \]
  da cui si ricava (tramite~\eqref{eq:secondo_grado})
  \[
  a_{n-1} = \frac 3 4 
  \qquad\lor\qquad
  a_{n-1} = \frac 1 4.
  \]
  Se $a_n$ era il primo termine con valore $\frac 3 4$ dovrà necessariamente
  essere $a_{n-1} = \frac 1 4$. Ma allora
  \[
  \frac 1 4 = a_{n-1} = 4 a_{n-2}(1-a_{n-2})
  \]
  da cui $a_{n-2} = \frac{2\pm\sqrt 3}{4}$. Ma ora osserviamo che essendo $a_0=
  \alpha = \frac 1 {42}$ un numero razionale, e osservando che $\QQ$ è un
  insieme invariante per $f$ (perché? verificare per induzione...)
  deduciamo che ogni $a_k \in \QQ$ e quindi
  avremmo $a_{n-2} = \frac{2\pm\sqrt 3}{4} \in \QQ$: assurdo.

  Stesso discorso si può fare se si avesse $a_n=0$, in quanto si
  avrebbe $a_{n-1} = 1$, $a_{n-2} = \frac 1 2$ e quindi $a_{n-3}=\frac{2 \pm \sqrt 2}{4}$.

  Dunque la successione $a_n$ non ammette limite.
\end{proof}

\begin{exercise}\label{ex_8}
  Si consideri la successione definita per ricorrenza
  \[
  \begin{cases}
    a_0 = \alpha\\
    a_{n+1} = \frac{1}{2-a_n}.
  \end{cases}
  \]
  Trovare il limite della successione nel caso $\alpha =
  -\the\year$. Determinare l'insieme dei valori di $\alpha$ per i quali la
  successione $a_n$ non è ben definita (in quanto per un qualche $n$ il
  denominatore $2-a_n$ si annulla).
  Trovare il limite nel caso $\alpha=\frac{\the\year}{1000}$.
\end{exercise}

\newsavebox{\qrexotto}\sbox{\qrexotto}{%
\myqrshortdoclink{ex8}{Diagramma a ragnatela relativo all'esercizio \getrefnumber{ex_8}}}
\begin{figure}
 \begin{center}
    \includegraphics[width=\textwidth]{fig_ex_8.png}
  \end{center}
  \caption{Diagramma a ragnatela relativo
    all'esercizio~\ref{ex_8}.
    \ifwidemargin\\\\\fi%
    \usebox{\qrexotto}}
  \label{fig_ex_8}
\end{figure}

\begin{proof}[Soluzione]
Posto $f(x) = 1/(2-x)$
si osserva che la disequazione $f(x)\ge x$ è verificata per ogni
$x<2$. L'equazione di punto fisso $f(x)=x$ ha come unica soluzione
$x=1$. Sull'intervallo $A=(-\infty,1)$ la funzione $f$ è crescente e
l'intervallo risulta essere invariante. Dunque per
$\alpha=-\the\year \in A$ la successione risulta essere crescente e superiormente
limitata. Dunque converge $a_n\to \ell$. Passando al limite in
$a_{n+1} = f(a_n)$ si trova che $\ell$ deve essere un punto fisso di
$f$ e quindi $\ell = 1$.

La successione non è ben definita se per qualche $n$ si trovasse
$a_n=2$ in quanto la funzione $f$ non è definita per $x=2$. Altri
valori si ottengono risalendo all'indietro la successione $a_n$.
Dalla equazione
\[
a_n = \frac{1}{2-a_{n-1}}
\]
si ricava
\[
a_{n-1} = 2-\frac{1}{a_n}.
\]
L'insieme dei punti partendo da quali si arriva prima o poi in $x=2$ è
dato dunque dai valori della successione
\[
\begin{cases}
  b_1 = 2\\
  b_{n+1} = 2 - \frac{1}{b_n}.
\end{cases}
\]
Osserviamo che in questo caso specifico è possibile ricavare una
formula esplicita per il termine $b_n$. Osserviamo infatti che:
\[
b_0 = 2,\quad
b_1 = \frac{3}{2},\quad
b_2 = \frac{4}{3}
\]
e proviamo a congetturare che sia $b_n = \frac{n+1} n$. In effetti questo
si può dimostrare per induzione. Per $n=1$ si ha $(n+1)/n = 2 =
b_1$. E se supponiamo che valga $b_n = (n+1)/n$ si ha
\[
b_{n+1} = 2 - \frac{n}{n+1} = \frac{2n+2-n}{n+1} = \frac{n+2}{n+1}.
\]
Dunque l'insieme dei punti partendo dai quali la successione $a_n$ non
è ben definita è dato da:
\[
  X= \ENCLOSE{\frac{n+1}{n}\colon n \in \NN}.
\]

Per il caso $\alpha=\frac{\the\year}{1000}$ osserviamo che sull'intervallo
$A_2 = (1,2)$ si ha sempre $f(x)>x$ (ma si potrebbe osservare che
$A_2$ non è invariante). Finché $a_n$ rimane in
tale intervallo la successione risulta quindi crescente. Però non è
possibile che la successione rimanga sempre in $A_2$ perché in tal
caso il limite dovrebbe essere un punto
fisso. Ma l'unico punto fisso è $1$ che è minore di $\alpha$ e quindi
la successione, crescente, non può convergere. Necessariamente la
successione esce dall'intervallo $A_2$ (in effetti notiamo che $\alpha
\not \in X$) e, per un certo $n$ si avrà $a_n>2$. Osserviamo ora che
sull'intervallo $A_3 = (2,+\infty)$ si ha $f(x)<0$ e dunque
se $a_n\in A_2$ necessariamente $a_{n+1} \in A$. Dunque questo caso si
riconduce al primo studiato, e la successione tende a $1$.
\end{proof}

\begin{exercise}
  Si consideri la successione definita per ricorrenza
  \[
  \begin{cases}
    a_0 = \alpha\\
    a_{n+1} = \frac{a_n^2-a_n}{2}.
  \end{cases}
  \]
  Determinare al variare di $\alpha$ il limite della successione.
\end{exercise}

\begin{exercise}
  Si consideri la successione definita per ricorrenza
  \[
  \begin{cases}
    a_0 = \alpha \\
    a_{n+1} = 1 - a_n^2.
  \end{cases}
  \]
  Determinare al variare di $\alpha$ il limite della successione.
\end{exercise}

\begin{exercise}
  Calcolare il limite della successione $a_n$ 
  definita per ricorrenza da:
    \[
    \begin{cases}
      a_0 = 1\\
      a_{n+1} = 1 - \frac {4}{a_n^2}.
    \end{cases}
    \]
  \end{exercise}
  
\begin{exercise}
  Calcolare il limite della successione $a_n$
  definita per ricorrenza da:
  \[
    \begin{cases}
      a_0 = 10\\
      a_{n+1} = a_n \cdot (\abs{a_n}-1).
    \end{cases}
  \]
\end{exercise}
  
\begin{exercise}
Calcolare
\[
 1 + \frac{1}{1+\frac{1}{1+\frac{1}{1+\frac{1}{\dots}}}}
\]
\end{exercise}

\begin{exercise}
Calcolare
\[
  \lim_{x\to 1^+} \sqrt{x-\sqrt{x- \sqrt{x-\sqrt{x - \dots}}}}
\]
\end{exercise}

\begin{exercise}[Mandelbrot reale]
\label{ex:mandelbrot_reale}
Si consideri, fissato il parametro $c$, la successione definita per ricorrenza:
\[
  \begin{cases}
    a_0 = 0\\
    a_{n+1} = a_n^2 + c.
  \end{cases}
\]

Determinare i valori di $c\in \RR$ per i quali la successione $a_n$ risulta
essere limitata.
\end{exercise}
%
\begin{proof}[Svolgimento.]
\emph{Caso 1: $c > \frac 1 4$}.
In tal caso non ci sono punti fissi, in quanto l'equazione $x=x^2+c$ ha
discriminante negativo. Significa che $x^2+c > x$ per ogni $x\in \RR$. Dunque
la successione $a_n$ è strettamente crescente e tende a $+\infty$.
Non è limitata.

\emph{Caso 2:} $0\le c \le \frac 1 4$.
In questo caso l'equazione $x=x^2+c$ ha due soluzioni entrambe positive
(le soluzioni hanno somma $1$ e prodotto $c\ge 0$).
Se chiamiamo $x_1$ la più piccola delle due soluzioni possiamo dimostrare che
l'intervallo $[0,x_1)$ è invariante. Infatti su tali intervallo la funzione
$f(x)=x^2+c$ è crescente, dunque se $0\le x < x_1$ si ha $f(0) \le f(x) < f(x_1)$
cioè $c \le f(x) < x_1$. Visto che $c\ge 0$ abbiamo mostrato che l'intervallo è
invariante e la successione è dunque limitata.
Se $c=0$ la successione $a_n$ rimane costante $a_n=0$. Se $c>0$ la successione
converge al punto fisso $x_1$. In ogni caso è limitata.

\emph{Caso 3:} $-1 \le c < 0$.
In questo caso vogliamo mostrare che l'intervallo $[c,0]$ è invariante.
La funzione $f(x) = x^2+c$ è decrescente su tale intervallo, dunque
se $c\le x \le 0$ risulta $f(0)\le x \le f(c)$. Ma $f(0)=c$ e $f(c)=c^2+c
= c(c+1) \le 0$ se $c\ge -1$. Dunque $[c,0]$ è invariante e $a_n$ rimane
limitata in tale intervallo.

\emph{Caso 4:} $-2\le c < -1$.
In questo caso l'equazione $x=x^2+c$ ha una soluzione negativa ed una soluzione
positiva. Chiamiamo $x_2$ la soluzione positiva. Vogliamo mostrare che
l'intervallo $[c,x_2]$ è invariante.
La funzione $f(x)=x^2+c$ è decrescente in $[c,0]$ e crescente in $[0,x_2]$.
Se $0\le x \le x_2$ si ha dunque $f(0)\le f(x) \le f(x_2)$
cioè $c \le f(x) \le x_2$. Dunque i punti in $[0,x_2]$ rimangono nell'intervallo
$[c,x_2]$.
Se invece $c\le x \le 0$ si ha $f(0)\le f(x) \le f(c)$ cioè $c \le f(x) \le c^2+c$.
Affinché sia $c^2+c\le x_2$ basta verificare che $f(c^2+c)\le c^2+c$
cioè:
\[
  (c^2+c)^2 + c \le c^2+c
\]
che, sviluppando il quadrato, si riduce a $c^3(c+2)\le 0$ che è verificata
se $-2 \le c \le 0$.
Dunque l'intervallo $[c,x_2]$ è invariante. La successione rimane dunque
limitata in tale intervallo.

\emph{Caso 5:} $c < -2$.
In questo caso $a_0=0$, $a_1=c$, $a_2=c^2+c$ e possiamo verificare che
$c^2+c > x_2$ in quanto, come nel caso precedente, questo accade se
\[
   (c^2+c)^2 + c > c^2+c
\]
che si riduce a $c^3(c+2)>0$ che è verificata se $c<-2$.
Ma l'intervallo $(x_2,+\infty)$ è invariante e su tale intervallo
si ha $f(x)>x$ dunque la successione $a_n$ è strettamente crescente per $n\ge 2$
e diverge a $+\infty$. Non è dunque limitata.

\emph{Conclusione}. La successione è limitata se $c\in[-2,1/4]$.
Altrimenti $a_n\to +\infty$.

\end{proof}

