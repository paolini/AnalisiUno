\section{successioni estratte}
%%%%%%%%%%%
%%%%%%%%%%%

\begin{definition}[sottosuccessione]
\mymark{*}
Se $a_n$ è una successione e $n_k$ è una successione strettamente crescente i cui valori sono numeri naturali, allora la successione
$b_k = a_{n_k}$ si dice essere una \emph{sottosuccessione}%
\mymargin{sottosuccessione}%
\index{sottosuccessione} di $a_n$
(o anche \emph{successione estratta} da $a_n$).
\end{definition}

Ricordando che una successione $a_n$ non è altro che una funzione
$\vec a\colon \NN \to \RR$, la successione $n_k$ corrisponde ad una funzione
$\vec n\colon \NN \to \NN$ e la sottosuccessione $a_{n_k}$ corrisponde alla
funzione composta $\vec a \circ \vec n$.

Si osservi che nella definizione precedente la variabile $n$ rappresenta
una variabile muta quando scriviamo la successione $a_n$, ma
rappresenta anche il nome della successione fissata $n_k$.
Questo sovraccarico
di significato è voluto e se usato correttamente rende più semplice
le notazioni, in quanto la successione $n_k$ viene sostituita alla
variabile $n$, con lo stesso nome, nella successione $a_n$.
La sottosuccessione $a_{n_k}$ risulta essere una successione nella variabile $k$, non nella variabile $n$.

\begin{example}
Sia $a_n = n^2$ la successione dei quadrati perfetti:
\begin{center}
\begin{tabular}{l|rrrrrrrrr}
$n$   & $0$ & $1$ & $2$ & $3$ & $4$  & $5$  & $6$  & \dots \\ \hline
$a_n$ & $0$ & $1$ & $4$ & $9$ & $16$ & $25$ & $36$ & \dots
\end{tabular}
\end{center}
Consideriamo la successione dei numeri pari $n_k = 2k$.
la corrispondente sottosuccessione dei quadrati perfetti
$b_k = a_{n_k}$
rappresenta la successione dei quadrati dei numeri pari:
\begin{center}
\begin{tabular}{l|rrrrrrrrr}
$k$       & $0$ & $1$ & $2$ & $3$ & $4$  & $5$  & $6$  & \dots \\ \hline
$n_k$ & $0$ & $2$ & $4$ & $6$ & $8$ & $10$ & $12$ & \dots \\
$a_{n_k}$ & $0$ & $4$ & $16$ & $36$ & $64$ & $100$ & $144$ & \dots
\end{tabular}
\end{center}
Si ha in pratica
  $b_k = a_{n_k} = a_{2k} = (2k)^2$.

Abbiamo in effetti \emph{estratto} alcuni dei termini della successione
originaria.
\end{example}

\begin{example}
Se $a_n = (-1)^n$ e $n_k=2k$ allora $a_{n_k} = 1$.
Vediamo quindi che una successione irregolare
può contenere una sottosuccessione regolare.
\end{example}

Osserviamo che se $\vec n\colon \NN\to \NN$ è una
funzione strettamente crescente
(cioè $n_k=\vec n(k)$ è una successione strettamente crescente di indici)
allora posto $A=\vec n(\NN)=\ENCLOSE{n_k\colon k\in \NN}$ si ha che
$\vec n \colon \NN \to A$ è una bigezione. Quindi $A$ è un insieme infinito.
Viceversa dato un qualunque insieme infinito $A\subset \NN$ esiste una
unica successione $\vec n\colon \NN \to A$ bigettiva e strettamente crescente:
basterà porre, per induzione,
$n_0 = \min A$, $n_1 = \min \ENCLOSE{n\in A \colon n > n_0}$
e, in generale,
 $n_{k+1} = \min\ENCLOSE{ n\in A \colon n > n_k}$.

Dunque possiamo identificare le sottosuccessioni di una successione
$\vec a \colon \NN \to \RR$ con le restrizioni ai sottoinsiemi infiniti di $\NN$.
Nell'esempio precedente, si è considerata la sottosuccessione
di tutti i termini con indice pari $n_k=2k$ per ottenere la sottosuccessione
$a_{n_k} = a_{2k}$. Si può equivalentemente pensare di prendere l'insieme di
tutti i numeri pari $A=2\NN$ e considerare la successione ristretta ai soli
indici pari:
\[
  a_0, a_2, a_4, \dots
\]
Se rinumeriamo gli indici pari usando tutti i numeri naturali otteniamo
la sottosuccessione $b_k=a_{n_k}$:
\[
  b_0 = a_0,\ b_1 = a_2,\ b_2 = a_4,\ \dots,\ b_k = a_{n_k},\ \dots
\]

\begin{lemma}[estratte monotone]%
\label{lem:estratte_monotone}%
Ogni successione $a_n\in \RR$ ha una estratta $a_{n_k}$ monotona.
Inoltre se $\sup a_n = +\infty$ c'è una estratta $a_{n_k}$
strettamente crescente che tende a $+\infty$.
\end{lemma}
%
\begin{proof}
Consideriamo l'insieme $P$ dei punti di ``picco'', ovvero degli indici
di quei termini della successione che sono maggiori o uguali a tutti i termini
seguenti:
\[
  P = \ENCLOSE{n\in \NN\colon m\ge n \implies a_n\ge a_m}.
\]
Se $P$ è finito
significa che esiste un indice $n_1\in \NN$ tale
che non ci sono picchi da $n_1$ in poi. In particolare $n_1$ non è un punto di
picco
quindi deve esistere $n_2>n_1$ tale che $a_{n_2}>a_{n_1}$.
Ma neanche $n_2$ è un punto di picco quindi deve esistere $n_3>n_2$ tale
che $a_{n_3}>a_{n_2}$... procedendo induttivamente si riesce quindi a definire
una successione $n_k$ di indici tali che $a_{n_k}$ risulta essere strettamente
crescente.

In particolare se $\sup a_n = +\infty$ siamo nella situazione precedente 
perché chiaramente in tal caso $P$ è vuoto visto che per ogni $n\in \NN$ 
deve esistere $m\in \NN$ tale che $a_m > \max\ENCLOSE{a_0, a_1, \dots a_n}$
e certamente $m>n$.

Se, viceversa, $P$ è infinito allora elencando in ordine i suoi elementi otterremo
una successione $n_1 < n_2 < n_3, \dots$ di indici ognuno dei quali corrisponde ad un valore
di picco. 
Se $j>k$ si ha dunque $n_j>n_k$ ed essendo $n_k\in P$ significa che
$a_{n_j} \le a_{n_k}$. 
Dunque la successione $a_{n_k}$ risulta essere decrescente.
\end{proof}


\begin{theorem}[Bolzano-Weierstrass]\label{th:Bolzano}
\label{th:bolzano_weierstrass}%
\mymark{***}%
\mymargin{Bolzano-Weierstrass}%
\index{Bolzano-Weierstrass}%
\index{teorema!di Bolzano-Weierstrass}%
Ogni successione $a_n$ ha una estratta regolare.
Più precisamente se $a_n$ è una successione limitata
allora esiste una sottosuccessione
$a_{n_k}$ convergente.
Se $a_n$ è una successione non limitata allora 
esiste una estratta $a_{n_k}$ divergente.
\end{theorem}
%
\begin{proof}
\mymark{***}
Cominciamo con il caso reale $a_n\in \RR$.
Il lemma~\ref{lem:estratte_monotone} garantisce 
che esiste una estratta $a_{n_k}$ monotona. 
Ma per il teorema~\ref{th:limite_successione_monotona} concludiamo 
immediatamente che $a_{n_k}$ ha limite.
Se $a_n$ è limitata anche $a_{n_k}$ è limitata e quindi 
in tal caso il limite è finito e dunque la successione 
estratta è convergente.

Se $a_n$ non è superiormente limitata il lemma 
ci garantisce che l'estratta tende a $+\infty$ 
e dunque è divergente.
Per simmetria se $a_n$ non è inferiormente limitata 
esiste una estratta che tende a $-\infty$ e quindi anche in
questo caso l'estratta è divergente.

Se $a_n$ è una successione di numeri complessi, si potrà scrivere
$a_n = x_n + i y_n$ con
$x_n$ e $y_n$ successioni reali. Se $a_n$ è limitata significa che $\abs{a_n}$
è superiormente limitata. Ma risulta $\abs{x_n} \le \abs{a_n}$ e
$\abs{y_n}\le \abs{a_n}$ quindi se $a_n$ è limitata anche la parte reale
$x_n$ e la parte immaginaria $y_n$ sono successioni limitate.
Allora $x_n$ ammette una sotto-successione convergente $x_{n_k}$.
Ma $y_{n_k}$ è anch'essa limitata e quindi anch'essa ammette una
sotto-sotto-successione $y_{n_{k_j}}$ convergente.
Dunque la sotto-sotto-successione $a_{n_{k_j}}$ è convergente.

Se $a_n\in \CC$ non è limitata, applicando il teorema al suo modulo $\abs{a_n}$
troviamo che c'è una estratta $a_{n_k}$ tale che $\abs{a_{n_k}}\to +\infty$.
Ma questo significa che $a_{n_k}\to \infty \in \bar \CC$.
\end{proof}

%%%%%%%%%%%%
%%%%%%%%%%%%
\subsection{punti limite}
%%%%%%%%%%%%
%%%%%%%%%%%%

\begin{theorem}[ponte di collegamento tra limiti di funzione e limiti di successione]%
\label{th:ponte}%
\mymark{***}%
Sia $A \subset \RR$, $f\colon A \to \RR$, sia $x_0$ un punto di accumulazione di $A$ e sia
$\ell \in [-\infty, +\infty]$.
Le due seguenti condizioni sono equivalenti:
\begin{enumerate}
\item $\displaystyle \lim_{x\to x_0} f(x) = \ell$;
\item per ogni successione $a_n\to x_0$ con $a_n\in A\setminus\ENCLOSE{x_0}$ risulta
\[
\lim_{n\to+\infty} f(a_n) = \ell. 
\]
\end{enumerate}
\end{theorem}
%
\begin{proof}
\mymark{***}
Se per $x\to x_0$ si ha $f(x)\to \ell$ e se $a_n \to x_0$ con $a_n\in A\setminus\ENCLOSE{x_0}$ la successione $f(a_n)$ non è altro che la composizione
della funzione $f$ con la funzione $n\mapsto a_n$. Si può quindi applicare
il teorema sul limite della funzione composta per ottenere che $f(a_n)\to \ell$.

Supponiamo viceversa di sapere che per ogni successione $a_n\to x_0$ si ha $f(a_n)\to \ell$. Vogliamo mostrare allora che $f(x)\to \ell$. Lo facciamo per assurdo: supponiamo che esista un intorno $U$ di $\ell$ tale che preso un qualunque intorno $V$ di $x_0$ non si abbia $f((A\setminus\ENCLOSE{x_0})\cap V)\subset U$.
Possiamo considerare per ogni $n\in \NN$ degli intorni $V_n$ sempre più piccoli. Ad esempio nel caso $x_0 \in \RR$ potremo scegliere $V_n = (x_0-1/n, x_0+1/n)$, nel caso $x_0 = +\infty$ si potrà scegliere $V_n = (n,+\infty]$ e nel caso $x_0=-\infty$ si sceglierà $V_n = [-\infty, -n)$.
Se per assurdo $f((A\setminus\ENCLOSE{x_0}\cap V_n))$ non fosse contenuto in $U$
significherebbe che per ogni $n\in\NN$ esisterebbe $a_n \in (A\setminus\ENCLOSE{x_0})\cap V_n$ tale che $f(a_n)\not \in U$. Ma allora $a_n$ risulterebbe essere una successione in
$A\setminus \ENCLOSE{x_0}$ con limite $x_0$
(in quanto per ogni intorno di $x_0$ esiste un $N$ tale che $V_N$ sia contenuto in tale intorno e per ogni $n>N$ si ha $V_n\subset V_N$)
ma $f(a_n)$ non potrebbe avere limite $\ell$
(essendo fuori dall'intorno $U$).
Ma questo nega l'ipotesi e conclude quindi la dimostrazione del teorema.
\end{proof}
\begin{proposition}[proprietà caratteristica della convergenza]
  \label{prop:convergenza}
Sia $f\colon A\subset \RR\to \RR$ e $x_0$ punto di accumulazione di $A$.
Sia $\ell\in \bar \RR$.
Se per ogni $a_n\to x_0$, $a_n\in A\setminus\ENCLOSE{x_0}$
esiste una estratta $a_{n_k}$ tale che $f(a_{n_k})\to \ell$ 
allora $f(x)\to \ell$ per $x\to x_0$.
\end{proposition}
%
\begin{proof}
  Se per assurdo non fosse $f(x) \to \ell$
  esisterebbe un intorno $U\in \B_\ell$
  per cui frequentemente $f(x) \not \in U$.
  Questo significa che esiste una successione
  $a_n\to x_0$ con $a_n\neq x_0$ tale che $f(a_n)\not \in U$.
  Ma allora da $f(a_n)$
  non è possibile estrarre una sottosuccessione
  che abbia limite $\ell$, e questo è contrario alle
  ipotesi.
\end{proof}

\begin{definition}[punti limite, limite superiore, limite inferiore]
  Sia $f\colon A\subset \RR \to \RR$ una funzione e $x_0\in \bar \RR$ 
  un punto di accumulazione per $A$.
  Una quantità $\ell\in \bar\RR$ si dice essere
  un \emph{punto limite}%
\mymargin{punto limite}%
\index{punto!limite} di $f(x)$ per $x\to x_0$ se 
  per ogni $U$ intorno di $\ell$ si ha $f(x)\in U$ 
  frequentemente per $x\to x_0$.
  
  Se denotiamo con $L\subset \bar\RR$ l'insieme
  dei punti limite possiamo definire il \emph{limite superiore} e il
  \emph{limite inferiore}
  \mymargin{limite superiore/inferiore}%
\index{limite!superiore/inferiore}
  rispettivamente come
  \[
  \limsup_{x\to x_0} f(x) = \sup L, \qquad
  \liminf_{x\to x_0} f(x) = \inf L.
  \]
\end{definition}
  
\begin{proposition}[base numerabile di intorni]%
  \label{prop:base_numerabile}%
  Per ogni $\ell\in \bar \RR$ esiste una successione $U_n$ di intorni di $\ell$ 
  con queste proprietà:
  \begin{enumerate}
    \item $U_{n+1}\subset U_n$;
    \item per ogni $U$ intorno di $\ell$ esiste $n\in \NN$ tale che $U_n\subset U$;
    \item se $a_n\in U_n$ allora $a_n\to \ell$.
  \end{enumerate}
\end{proposition}
\begin{proof}
Possiamo esplicitamente definire gli intorni $U_n$ come segue:
\[
  U_n = 
  \begin{cases}
    \openinterval{\ell-\frac 1 n}{\ell+\frac 1 n} & \text{se $\ell\in \RR$}\\ 
    \opencloseinterval{n}{+\infty} & \text{se $\ell=+\infty$}\\
    \closeopeninterval{-\infty}{-n} & \text{se $\ell=-\infty$.}
  \end{cases}
\]
La prima proprietà è ovviamente verificata.
La proprietà archimedea dei numeri reali garantisce la validità della seconda 
proprietà, da cui segue immediatamente la terza.
\end{proof}

\begin{proposition}[caratterizzazione dei punti limite]
  Sia $f\colon A\subset \RR\to \RR$, $x_0\in \bar \RR$ 
  punto di accumulazione per $A$. 
  Sono equivalenti:
  \begin{enumerate}
    \item $\ell$ è un punto limite di $f(x)$ per $x\to x_0$.
    \item esiste una successione $a_n\in A$, $a_n\neq x_0$, $a_n\to x_0$ 
    tale che $f(a_n)\to \ell$.
  \end{enumerate}
\end{proposition}
%
\begin{proof}
  Siano $U_n$ intorni di $\ell$ e $V_n$ intorni di $x_0$ definiti 
  come nella proposizione~\ref{prop:base_numerabile}.
  Se $\ell$ è un punto limite di $f(x)$ per $x\to x_0$ 
  significa che per ogni $U$ intorno di $\ell$ e per ogni $V$ 
  intorno di $x_0$ esiste $x\in A\cap V\setminus\ENCLOSE{x_0}$ 
  tale che $f(x)\in U$.
  Dunque per ogni $n$ esiste $a_n\in A \cap V\setminus\ENCLOSE{x_0}$ 
  tale che $a_n\in V_n$ e $f(a_n)\in U_n$. 
  Significa che $a_n\to x_0$, $a_n\neq x_0$, $f(a_n)\to \ell$ 
  come volevasi dimostrare.
  
  Viceversa se esiste una tale successione $a_n\to x_0$ allora 
  per ogni $V$ intorno di $x_0$ si ha definitivamente $a_n\in V$.
  E se $f(a_n)\to \ell$ per ogni $U$ intorno di $\ell$
  si ha anche $f(a_n)\in U$ definitivamente.
  Dunque esiste $n$ tale che $a_n\in V$ e $f(a_n)\in U$ confermando 
  quindi che $f(x)\in U$ frequentemente. 
\end{proof}

Molto spesso considereremo i punti limite di una successione $a_n$
per $n\to +\infty$.
In tal caso la caratterizzazione precedente ci dice che $\ell$ 
è un punto limite di $a_n$ per $n\to+\infty$ se esiste 
una successione di indici $n_k\to+\infty$ tale che $a_{n_k}\to \ell$.
Potremmo anche supporre $n_k$ strettamente crescente in quanto se 
$n_k\to \infty$ possiamo estrarre da $n_k$ una sottosuccessione 
strettamente crescente. 
Dunque l'insieme dei punti limite di una successione $a_n$ 
corrisponde all'insieme dei limiti di tutte le possibili 
sottosuccessioni di $a_n$.

\begin{example}
  La successione $a_n=(-1)^n$ ha due punti limite:
  \[
    \limsup_{n\to +\infty}(-1)^n = 1, \qquad \liminf_{n\to+\infty} (-1)^n = -1.
  \]
  Infatti la sottosuccessione dei termini con indice pari è costante $1$ mentre
  quella dei termini di indice dispari è costante $-1$.
  Non ci possono essere altri punti limite perché se ci fosse $a_{n_k}\to \ell$
  allora certamente $a_{n_k}=1$ frequentemente oppure $a_{n_k}=-1$
  frequentemente da cui o $\ell=1$ oppure $\ell=-1$.
\end{example}
%
\begin{example}
  Visto che $\#\QQ=\#\NN$ esiste una funzione $\vec a \colon \NN \to \QQ$
  surgettiva. Utilizzando la proprietà di densità dei numeri razionali
  si può dimostrare che l'insieme dei punti limite della corrispondente successione
  $a_n = \vec a(n)$ è tutto $\bar \RR$.
\end{example}

\begin{exercise}
  Si consideri la successione $a_n = \sqrt n -\lfloor \sqrt n\rfloor$.
  Calcolare 
  \[
    \liminf_{n\to+\infty} a_n, \qquad 
    \limsup_{n\to+\infty} a_n.
  \]
  Qual è l'insieme dei punti limite di $a_n$ per $n\to +\infty$?
\end{exercise}

%
\begin{theorem}[proprietà del limite superiore/inferiore]
Sia $f\colon A\subset \RR \to \RR$ e sia $x_0$ un punto di accumulazione per $A$.
Sia $L$ l'insieme dei punti limite di $f(x)$ per $x\to x_0$. 
Allora:
\begin{enumerate}
  \item %1
  $L\neq \emptyset$;

  \item %2
  $\displaystyle\limsup_{x\to x_0} f(x) \ge \liminf_{x\to x_0} f(x)$;

  \item %3
  se $\displaystyle\limsup_{x\to x_0} f(x) = \liminf_{x\to x_0} f(x) = \ell$ 
  allora $\displaystyle\lim_{x\to x_0} f(x) = \ell$;

  \item %4
  l'insieme dei punti limite è chiuso per passaggio al limite:
  se $\ell_k\in L$ e $\ell_k \to \ell$ per qualche $\ell \in \bar \RR$ 
  allora $\ell \in L$;

  \item %5
  $\displaystyle\limsup_{x\to x_0} f(x)$ e $\displaystyle\liminf_{x\to x_0} f(x)$ sono punti limite;

  \item %6
  la condizione
  $\displaystyle\limsup_{x\to x_0} f(x) = \ell$ è equivalente a
  \[
  \begin{cases}
   \forall q > \ell \colon f(x) < q \text{ definitivamente,} \\
   \forall q < \ell \colon f(x) > q \text{ frequentemente,}
  \end{cases}
  \]
  e la condizione $\displaystyle\liminf_{x\to x_0} f(x) = \ell$ è equivalente a
  \[
  \begin{cases}
  \forall q > \ell \colon f(x) < q \text{ frequentemente,} \\
  \forall q < \ell \colon f(x) > q \text{ definitivamente;}
  \end{cases}
  \]

  \item %7
  se $a_n$ è una successione 
  \[
    \limsup_{n\to +\infty} a_n = \lim_{n\to +\infty} \sup_{k\ge n} a_k,
    \quad
    \liminf_{n\to +\infty} a_n = \lim_{n\to +\infty} \inf_{k\ge n} a_k.
  \]
 \end{enumerate}
\end{theorem}
%
\begin{proof}
  Per quanto riguarda il punto 1.\
  il teorema~\ref{th:bolzano_weierstrass} di Bolzano-Weierstrass
  garantisce che sia $L\neq \emptyset$ e
  quindi $\sup L \ge \inf L$ da cui discende il punto 2.

  Per il punto 3.\ se $\limsup = \liminf = \ell$ significa che $L=\ENCLOSE{\ell}$
  ha un solo elemento. Ma per il corollario al teorema di Bolzano Weierstrass
  sappiamo che da ogni successione $f(a_n)$ con $a_n\to x_0$ 
  è possibile estrarre una sottosuccessione $f(a_{n_k})$ regolare. 
  Il limite di tale sottosuccessione deve essere un elemento di $L$
  e quindi non può che essere $\ell$. 
  Allora per la proposizione~\ref{prop:convergenza}
  deduciamo che l'intera successione ha limite $\ell$.

  Per il punto 4.\ sia $\ell_k\in L$ una successione di punti limite
  e sia $\ell\in \bar \RR$ tale che $\ell_k \to \ell$ per $k\to +\infty$.
  Ora consideriamo la successione $U_n$ di intorni di $\ell$ 
  data dalla proposizione~\ref{prop:base_numerabile}.
  Visto che $\ell_k\to \ell$ per ogni $n$ deve esistere $k_n$ tale 
  che $\ell_{k_n}\in U_n$. Senza perdita di generalità possiamo 
  supporre direttamente che sia $\ell_n\in U_n$.
  Consideriamo anche gli intorni $V_n$ di $x_0$ dati sempre 
  dalla proposizione~\ref{prop:base_numerabile}.
  Per ogni $\ell_n \in L$ deve esistere una successione $a_k\to x_0$ 
  con $a_k\neq x_0$ tale che $f(a_k)\to \ell_n$.
  Ma allora certamente esiste $k=k_n$ tale che $a_{k_n}\in V_n$ 
  e $f(a_{k_n})\in U_n$. 
  Posto $b_n = a_{k_n}$ abbiamo trovato una successione $b_n$ 
  tale che $b_n\to x_0$ (in quanto $b_n\in V_n$) e $f(b_n)\to \ell$
  in quanto $f(b_n)\in U_n$. Dunque $\ell$ è anch'esso un punto limite. 

  Per il punto 5
  visto che $L\neq \emptyset$ la caratterizzazione del $\sup$
  garantisce che esista una successione $\ell_n\in L$ tale che $\ell_n \to \sup L$.
  Ma allora per il punto precedente si deve avere $\sup L \in L$.
  Lo stesso per l'$\inf$.

  Per il punto 6.\ facciamo la dimostrazione per il $\limsup$ (per il $\liminf$
  sarà analogo). Se $\limsup f(x) = \ell$ e se fosse frequentemente
  $f(x) \ge q > \ell$ allora esisterebbe una successione $a_n\to x_0$, 
  $a_n\neq x_0$ tale che $f(a_n)\ge q$.
  Tale successione avrebbe una estratta regolare
  che ha limite $\ge q> \ell$, il che è assurdo.
  Dunque definitivamente deve essere $f(x) < q$ per ogni $q>\ell$.
  Se invece fosse definitivamente $f(x) \le q < \ell$ per ogni
  successione $a_n\to x_0$ con $a_n\neq x_0$ si dovrebbe avere 
  $f(a_n) \le q$ e questo contraddice il fatto che $\ell>q$ 
  è un punto limite.

  Viceversa se per ogni $q>\ell$ si ha $f(x)<q$ definitivamente,
  significa che per ogni successione $a_n\to x_0$ si ha
  $f(a_n) < q$ definitivamente e quindi se $f(a_n)\to \ell$
  dovrà essere $\ell\le q$. 
  Dunque ogni $q>\ell$ è un maggiorante di $L$ e $\sup L\le \ell$.
  Se poi per ogni $q<\ell$ si ha $f(x)\ge q$ frequentemente
  significa che esiste una successione $a_n\to x_0$, $a_n\neq x_0$ 
  tale che $f(a_n)\ge q$. 
  Per il teorema di Bolzano-Weierstrass si potrà trovare 
  una estratta convergente $f(a_{n_k})\to \ell'\ge q$.
  Dunque per ogni $q<\ell$ risulta
  $\sup L \ge q$ da cui in definitiva $\sup L = \ell$. 

  Per il punto 7.\ facciamo la dimostrazione per il $\limsup$ (per il $\liminf$
  sarà analogo).
  Posto $A_n = \sup_{k\ge n} a_k$ osserviamo che $A_n$ è decrescente
  in quanto all'aumentare di $n$ l'insieme
  $\ENCLOSE{k\colon k \ge n}$ decresce (nel senso dell'inclusione insiemistica)
  e quindi
  il $\sup$ non aumenta.
  Dunque $\ell=\lim A_n$ esiste certamente in $\bar \RR$.
  Inoltre per definizione di limite per ogni $\ell'>\ell$
  si dovrà avere $A_n < \ell'$ definitivamente e quindi
  (essendo ovviamente $a_n \le A_n$) si avrà
  anche $a_n < \ell'$ definitivamente.
  Viceversa preso $\ell'<\ell$ si avrà definitivamente
  $A_n > \ell'$. Ma questo significa che esiste $k>n$
  per cui si ha $a_k > \ell'$ e quindi
  risulta $a_n > \ell'$ frequentemente.
  Per il punto precedente si può quindi concludere che
  $\ell = \limsup a_n$.
\end{proof}

\begin{theorem}[operazioni con $\limsup$ e $\liminf$]
  Siano $f,g\colon A\subset \RR\to\RR$ e sia $x_0$ un punto di accumulazione di $A$. 
  \begin{enumerate}
    \item 
      Per $x\to x_0$ si ha 
      \begin{align*}
      \limsup_{x\to x_0} (-f(x)) &= -\liminf_{x\to x_0} f(x)\\ 
      \liminf_{x\to x_0} (-f(x)) &= -\limsup_{x\to x_0} f(x);
      \end{align*}
    \item
      se $\lambda \ge 0$ allora
        \begin{align*}
        \limsup_{x\to x_0} (\lambda \cdot f(x)) &= \lambda \cdot \limsup_{x\to x_0} f(x), \\
        \liminf_{x\to x_0} (\lambda \cdot f(x)) &= \lambda \cdot \liminf_{x\to x_0} f(x);
        \end{align*}
    \item
    inoltre
    \begin{gather*}
    \limsup_{x\to x_0} (f(x) + g(x)) \le \limsup_{x\to x_0} f(x) + \limsup_{x\to x_0} g(x),\\
    \liminf_{x\to x_0} (f(x) + g(x)) \ge \liminf_{x\to x_0} f(x) + \liminf_{x\to x_0} g(x);
    \end{gather*}
    \item
    e infine se $f(x) \ge g(x)$ allora
    \[
     \limsup_{x\to x_0} f(x) \ge \limsup_{x\to x_0} g(x), \qquad \liminf_{x\to x_0} f(x) \ge \liminf_{x\to x_0} g(x).
    \]
  \end{enumerate}
\end{theorem}
%
\begin{proof}
  Per il punto 1.\ basti osservare che se la funzione $f(x)$ ha $L$ come
  insieme dei punti limite allora la funzione $-f(x)$ ha $-L$ come punti
  limite. Quindi $\sup (-L) = -\inf L$ e $\inf(-L) = -\sup L$.

  Per il punto 2.\ si osservi che se $L$ è l'insieme dei punti limite
  di $f(x)$ allora l'insieme dei punti limite di $\lambda f(x)$ è $\lambda L$.
  Se $\lambda \ge 0$ si ha dunque $\sup \lambda L = \lambda \sup L$
  e $\inf \lambda L = \lambda \inf L$ (se $\lambda<0$ invece $\inf$ e $\sup$
  si scambiano, come nel punto 1).

  Per il punto 3.\ consideriamo il caso del $\limsup$ (per il $\liminf$ sarà analogo).
  Se $\ell = \limsup(f(x)+g(x))$ significa che esiste una successione
  di $a_n\to x_0$ tale che $f(a_n)+g(a_n)\to \ell$. 
  Ma posso estrarre una sottosuccessione
  tale che anche il primo addendo $f(a_{n_k})$ abbia limite. 
  E poi posso estrarre
  una sotto-sottosuccesione in modo che anche il secondo addendo $g(a_{n_{k_j}})$
  abbia limite. 
  Dunque avremo $f(a_{n_{k_j}}) \to \ell_1$, $g(a_{n_{k_j}} \to \ell_2$
  con $\ell_1+\ell_2=\ell$.
  Ma allora per definizione di $\limsup$ si avrà $\limsup f(x) \ge \ell_1$
  e $\limsup g(x) \ge \ell_2$ da cui $\limsup f(x) + \limsup g(x) \ge \ell_1+\ell_2 = \ell$.

  Per il punto 4.\ si osserva che se $\ell = \limsup f(x)$ allora
  per ogni $q>\ell$ si ha definitivamente
  $f(x)<q$ e di conseguenza anche $g(x) < q$ definitivamente.
  Dunque $\limsup g(x) \le \ell$.
  Se invece poniamo $\ell = \liminf h(x)$ allora
  per ogni $q<l$ si ha definitivamente $g(x) \ge q$ ma
  allora anche $f(x)\ge q$ defitiviamente e quindi
  $\liminf f(x) \ge \ell$.
\end{proof}
    
\begin{theorem}[convergenza alla Cesàro]
  \label{th:criterio_cesaro}%
  \mymark{*}%
  \mymargin{Cesàro}%
\index{Cesàro}%
  \index{criterio!del rapporto alla Cesàro}%
  \index{somma!di Cesàro}%
  Sia $a_n$ una successione.
  \begin{enumerate}
  \item
    Se
    $   a_n \to \ell \in \bar \RR$
    allora
    \[
    \frac 1 n \cdot \displaystyle\sum_{k=1}^n a_k \to \ell.
    \]
  
  \item
    Se $a_n>0$,
    $\displaystyle\frac{a_{n+1}}{a_n} \to \ell \in [0,+\infty]$
    allora
    $\displaystyle \sqrt[n]{a_n}\to \ell$.
  \end{enumerate}
  \end{theorem}
  %
  \begin{proof}
  Dimostriamo il primo punto.
  Per ogni $q<\ell$ visto che $a_n\to \ell$ deve esistere $N$ tale che 
  $a_n\ge q$ se $n> N$. 
  Dunque 
  \[
    b_n = \frac 1 n \sum_{k=1}^{n} a_k 
    \ge \frac 1 n \sum_{k=1}^N a_k + \frac 1 n \sum_{k=N+1}^n q 
    = \frac{\sum_{k=1}^N a_k}{n} + \frac{n-N}{n}\cdot q \to q.
  \]
  Significa che per ogni $q<\ell$ si ha $\liminf b_n \ge q$ e 
  dunque $\liminf b_n \ge \ell$.
  Viceversa per ogni $q>\ell$ ragionando in maniera analoga si ottiene 
  che $b_n$ non supera una successione che tende a $q$.
  Dunque $\limsup b_n\le \ell$. 
  Mettendo insieme le cose si deduce che $\lim b_n = \ell$.
    
  Il punto 2 si può ricondurre all'1.
  Infatti
  \[
    \ln \sqrt[n]{a_n}
    = \ln \sqrt[n]{a_0\cdot \frac{a_1}{a_0} \cdots \frac{a_n}{a_{n-1}}}
    = \frac{\ln a_0 + \ln \frac{a_1}{a_0} + \dots + \ln \frac{a_n}{a_{n-1}}}{n}.
  \]
  Posto $x_n = \ln \frac{a_n}{a_{n-1}}$
  se $\frac{a_n}{a_{n-1}}\to \ell$
  si ha $x_n\to \ln \ell$ (intendendo $\ln 0 = -\infty$ e $\ln (+\infty)=+\infty$) e dunque
  \[
    \ln \sqrt[n]{a_n} = \frac{\ln a_0}{n} + \frac{x_1 + \dots + x_n}{n}
    \to \ln \ell.
  \]
  Facendo l'esponenziale di ambo i membri si trova il risultato desiderato.
  \end{proof}
  
  \begin{exercise}\label{ex:7340098}
  Si applichi il risultato precedente per
  verificare che
  \[
     \lim \sqrt[n]{n} = 1
  \]
 e
 \index{fattoriale!stima asintotica}%
 \[
   \lim \frac{n}{\sqrt[n]{n!}} = e.
 \]
 \end{exercise}
 \mynote{Nell'esercizio\ref{ex:7340098} si dimostra che 
 \[
  \sqrt[n]{n!} \sim \frac{n}{e}  
  \qquad\text{per $n\to +\infty$.}
 \]
Si faccia attenzione che non è possibile elevare alla $n$ 
entrambi i lati di questa stima asintotica.
Infatti nel Teorema~\ref{th:stirling} troveremo questa stima 
asintotica per il fattoriale:
 \[
  n! \sim \sqrt{2\pi n} \cdot \frac{n^n}{e^n}.
 \]
 Si veda l'esempio~\ref{ex:498124} per un risultato simile.%
 }

 \begin{exercise}
 Si consideri la successione
 \[
 a_n =
 \begin{cases}
    2^n &\text{se $n$ pari},\\
    n\cdot 2^n &\text{se $n$ dispari}.
 \end{cases}
 \]
 Verificare che alla successione $a_n$
  si può applicare il criterio della radice ma
  non il criterio del rapporto.
  Usare questo esempio per mostrare che le implicazioni
  enunciate nel teorema~\ref{th:criterio_cesaro} non
  possono essere invertite.
\end{exercise}  

\subsection{il teorema degli zeri}

\begin{theorem}[degli zeri]
\mymark{***}%
\mymargin{teorema degli zeri}%
\index{teorema!degli zeri}%
\label{th:zeri}%
Sia $f\colon[a,b] \to \RR$, una funzione
continua tale che $f(a)\le 0$ e $f(b)\ge 0$.
\mynote{Se $b<a$ si intende $[a,b]=[b,a]$.}
Allora esiste
 $c\in [a,b]$ tale che $f(c)=0$.
\end{theorem}

\begin{proof}
\mymark{***}
La dimostrazione che adottiamo è di particolare rilevanza in quanto
non solo permette di dimostrare l'esistenza del punto $c$ che risolve
$f(x)=0$
ma ci presenta
un algoritmo, il \emph{metodo di bisezione}%
\mymargin{metodo di bisezione}%
\index{metodo!di bisezione},
\index{bisezione!metodo di}
che può essere effettivamente utilizzato per approssimare
tale soluzione.

Possiamo supporre senza perdere di  generalità che sia $a<b$.
Poniamo $A_0 = a$, $B_0= b$ e consideriamo il punto medio $C_0 = (A_0+B_0)/2$.
Scegliamo tra i due intervalli $[A_0, C_0]$ e $[C_0,B_0]$ quello per cui
il segno ai due estremi è discorde (o, caso fortunato, nullo).
Più precisamente se $f(C_0)\ge 0$ poniamo $[A_1,B_1] = [A_0,C_0]$ altrimenti
scegliamo $[A_1,B_1] = [C_0,B_0]$ così si ha, in ogni caso,
$f(A_1)\le 0$, $f(B_1)\ge 0$.

Consideriamo il punto medio $C_1$ del nuovo intervallo $[A_1,B_1]$ e ripetiamo
il procedimento indefinitamente. Quello che otteniamo sono due successioni
$A_n$, $B_n$ con queste proprietà (che potrebbero essere dimostrate per induzione):
\begin{enumerate}
\item $A_n < B_n$, $B_n - A_n = (b-a)/2^n$;
\item $A_n$ è crescente, $B_n$ è decrescente;
\item $f(A_n)\le 0$, $f(B_n)\ge 0$.
\end{enumerate}

Essendo $A_n$ monotòna sappiamo che $A_n$ converge $A_n\to c$.
Inoltre visto che $A_n \in [a,b]$ anche $c\in [a,b]$ (per la permanenza del
segno delle successione $A_n-a$ e $b-A_n$).
Passando al limite nell'uguaglianza $B_n = A_n + (b-a)/2^n$
si ottiene che anche $B_n \to c$. Essendo $f$ continua
avremo
\[
f(A_n) \to f(c), \qquad
f(B_n) \to f(c).
\]
Ma $f(A_n)\le 0$ e quindi per la permanenza del segno anche $f(c)\le 0$.
D'altra parte $f(B_n) \ge 0$ e quindi $f(c)\ge 0$.
Si ottiene dunque $f(c) = 0$, come volevamo dimostrare.
\end{proof}

\begin{example}\label{ex:75445}
Si voglia risolvere l'equazione
\[
  x^5-x-1=0.
\]
\end{example}
%
\begin{proof}[Svolgimento]
Posto $f(x) = x^5-x-1$ è chiaro che la funzione $f\colon \RR\to \RR$
è continua (in quanto composizione di funzioni continue).
Osserviamo che $f(0) = -1$ e $f(2)=29$, dunque la funzione
soddisfa le ipotesi del teorema degli zeri sull'intervallo $[0,2]$.
Sappiamo quindi che l'equazione in questione ha almeno una soluzione
in tale intervallo.

Utilizzando il metodo di bisezione possiamo determinare una soluzione
con precisione arbitraria. Posto $A_0=0$, $B_0=2$ abbiamo verificato che
$f(A_0)<0$ e $f(B_0)>0$.
Prendiamo il punto
medio $C_0=1$ e calcoliamo la funzione: $f(C_0)=-1 < 0$. Sappiamo
allora che una soluzione deve essere compresa nell'intevallo
$[A_1,B_1] = [C_0,B_0] = [1,2]$ perché anche in tale intervallo valgono le ipotesi
del teorema degli zeri.
Il punto medio di tale intervallo è $C_1=3/2 = 1.5$
e risulta $f(3/2) = 163/32>0$ dunque l'intervallo successivo
che andremo a considerare è $[A_2,B_2]=[1,3/2]$.
Per non dover lavorare con troppe cifre decimali invece di suddividere
esattamente a metà quest'ultimo intervallo consideriamo un punto
intermedio $C_2 = 6/5 = 1.2$ dove si ha $f(C_2)=901/3125>0$.
Sappiamo allora che una soluzione è compresa nell'intervallo
$[A_3,B_3] = [1,1.2]$. Prendiamo il punto medio $C_3=11/10=1.1$
e troviamo $f(C_3) = -48949/10^5 <0$. Abbiamo quindi ottenuto
che esiste $x\in (1.1,1.2)$ tale che $f(x)=0$. Sappiamo quindi
che $\abs{x-1.15} < 0.05$ cioè abbiamo trovato $x$ con un errore
inferiore a $0.05$.

Con molta pazienza si può procedere
con il metodo di bisezione fino ad arrivare a verificare
che $f(116/10^2)$ $=$ $-596583424/10^{10}<0$ e $f(117/10^2)=224480357/10^{10}>0$ da cui
si ottiene che una soluzione è compresa tra $1.16$ e $1.17$ con un errore
inferiore a $0.005$.
Con il calcolatore (si veda ad esempio il codice a pagina \pageref{code:bisection})
si possono ottenere più cifre significative: $x=1.1673039782614187\ldots$
\end{proof}

\begin{table}
\begin{center}
\begin{tabular}{r}
$\sqrt 2 \approx $ \ttfamily\footnotesize 
1.4142135623 7309504880 1688724209 6980785696 7187537694 \\ \ttfamily\footnotesize
8073176679 7379907324 7846210703 8850387534 3276415727 \\
% 3501384623 0912297024 9248360558 5073721264 4121497099 \\ \ttfamily\footnotesize
% 9358314132 2266592750 5592755799 9505011527 8206057147 \\ \ttfamily\footnotesize
% 0109559971 6059702745 3459686201 4728517418 6408891986 \\ \ttfamily\footnotesize
% 0955232923 0484308714 3214508397 6260362799 5251407989 \\ \ttfamily\footnotesize
% 6872533965 4633180882 9640620615 2583523950 5474575028 \\ \ttfamily\footnotesize
% 7759961729 8355752203 3753185701 1354374603 4084988471 \\ \ttfamily\footnotesize
% 6038689997 0699004815 0305440277 9031645424 7823068492 \\ \ttfamily\footnotesize
% 9369186215 8057846311 1596668713 0130156185 6898723723 \\ \ttfamily\footnotesize
% 5288509264 8612494977 1542183342 0428568606 0146824720 \\ \ttfamily\footnotesize
% 7714358548 7415565706 9677653720 2264854470 1585880162 \\ \ttfamily\footnotesize
% 0758474922 6572260020 8558446652 1458398893 9443709265 \\ \ttfamily\footnotesize
% 9180031138 8246468157 0826301005 9485870400 3186480342 \\ \ttfamily\footnotesize
% 1948972782 9064104507 2636881313 7398552561 1732204024 \\ \ttfamily\footnotesize
% 5091227700 2269411275 7362728049 5738108967 5040183698 \\ \ttfamily\footnotesize
% 6836845072 5799364729 0607629969 4138047565 4823728997 \\ \ttfamily\footnotesize
% 1803268024 7442062926 9124859052 1810044598 4215059112 \\ \ttfamily\footnotesize
% 0249441341 7285314781 0580360337 1077309182 8693147101 \\ \ttfamily\footnotesize
% 7111168391 6581726889 4197587165 8215212822 9518488472 \\
\\
$\sqrt 3 \approx$ \ttfamily\footnotesize 
1.7320508075 6887729352 7446341505 8723669428 0525381038 \\ \ttfamily\footnotesize
0628055806 9794519330 1690880003 7081146186 7572485757 \\
\\
$\phi = \frac{\sqrt 5+1}{2} \approx $ \ttfamily\footnotesize 
1.6180339887 4989484820 4586834365 6381177203 0917980576 \\ \ttfamily\footnotesize
2862135448 6227052604 6281890244 9707207204 1893911375
  \end{tabular}
\end{center}
\caption{Le prime 100 cifre decimali di alcune
costanti calcolate con il metodo di bisezione usato nella dimostrazione
del teorema~\ref{th:zeri}.
Si veda il codice a pagina~\pageref{code:bisection}.}
\label{fig:cifre_sqrt2}
\index{$\sqrt 2$!cifre decimali}
\index{cifre!$\sqrt 2$}
\end{table}

\begin{theorem}[teorema dei valori intermedi]
\label{th:valori_intermedi}%
\mymark{**}%
\mymargin{proprietà dei valori intermedi}%
\index{proprietà!dei valori intermedi}%
\index{teorema!dei valori intermedi}%
Sia $I\subset \RR$ un intervallo e $f\colon I \to \RR$ una
funzione continua.
Allora se $f$ assume due valori $y_1$ e $y_2$ allora $f$
assume anche tutti i valori intermedi tra $y_1$ e $y_2$.
Detto altrimenti: una funzione continua
manda intervalli in intervalli.
\end{theorem}
%
\begin{proof}
Se $y_1$ e $y_2$ sono valori assunti da $f$ significa
che esistono $x_1,x_2 \in I$ tali che $f(x_1)= y_1$ e $f(x_2)=y_2$.
Allora scelto $y$ si consideri la funzione $g(x) = f(x)-y$.
Se $y$ è intermedio tra $y_1$ e $y_2$ la funzione $g$ assumerà
segni opposti in $x_1$ e $x_2$ e dunque, per il teorema degli zeri,
dovrà esserci un punto $x$ in cui $g$ si annulla. In tale punto
si avrà dunque $f(x)=y$, come volevamo dimostrare.
\end{proof}

\begin{lemma}
\label{ex:inversa_monotona}%
Se $I$ è un intervallo di $\RR$ ogni funzione $f\colon I \to \RR$
iniettiva e continua è strettamente monotona.
\end{lemma}
%
\begin{proof}
Si può osservare che una funzione è strettamente monotona se mantiene i valori
intermedi cioè se dati tre punti
$x<y<z$ risulta sempre che $f(y)$ è un valore intermedio tra $f(x)$ e $f(z)$:
\[
  f(x)< f(y) <f(z) \qquad\text{oppure} \qquad f(x)> f(y) > f(z).
\]
Se ciò non accadesse, ad esempio se fosse $f(y)>f(z)>f(x)$ con $x<y<z$
allora per la continuità di $f$ dovrebbe esistere un valore intermedio
tra $x$ e $y$ in cui la funzione assume il valore $f(z)$. Ma allora la funzione
non sarebbe iniettiva.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%
