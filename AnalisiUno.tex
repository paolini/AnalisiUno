\documentclass[italian,twoside,headinclude,10pt]{scrbook}
\usepackage{qrcode}
\usepackage{amsmath,amssymb,amsthm,thmtools}
\usepackage{mathtools} % per \MoveEqLeft
\usepackage{babel}
\usepackage{caption,subcaption}
\usepackage[nochapters,pdfspacing]{classicthesis}
%\usepackage{hyperref} % enable if classicthesis is disabled
%\usepackage{createspace/createspace}
\usepackage[paperwidth=7in,paperheight=10in,bindingoffset=0.625in,marginparwidth=53.3pt,top=70.7pt,bottom=70.7pt,marginparsep=11.9pt]{geometry}
\usepackage[utf8]{inputenc}
\usepackage{comment} % for the comment environment
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{pgfplots} % per disegnare i grafici di funzione
\usepackage{pst-node}
\usetikzlibrary{cd,calc,backgrounds} % commutative diagrams
\usepackage{eucal}
\usepackage{sidenotes}
\usepackage{hyphenat}
\usepackage{marginnote}
\usepackage{mparhack} % fix margin notes (otherwise sometime they go to wrong margin!)
\usepackage{expl3} % per il comando \regex_replace_once
\usepackage{xifthen}
\usepackage{listings} % per il codice python
\usepackage{array} % per formattare le colonne di un tabular
\usepackage[type={CC},modifier={by-nc-sa},version={4.0},lang={en}]{doclicense}
%\usepackage{axessibility}

\AfterPreamble{\hypersetup{hidelinks=true,}}
\definecolor{Black}{gray}{0}

%\usepackage{showkeys}

\usepackage{makeidx} % glossario

\usetikzlibrary{arrows}

\graphicspath{{figures/}}

% patch del codice di ClassicThesis
% per evitare che i numeri dei capitoli a due
% cifre escano dai margini
\begin{comment} % disabilitato se ho solo 9 capitoli
\titleformat{\chapter}[display]%
{\relax}{\mbox{}\oldmarginpar{\vspace*{-3\baselineskip}\makebox[0pt]{\color{halfgray}\chapterNumber{\phantom{0}\thechapter}}}}{0pt}%
{\raggedright\spacedallcaps}[\normalsize\vspace*{.8\baselineskip}\titlerule]%
\end{comment}

\newcommand{\eps}{\varepsilon}
\renewcommand{\phi}{\varphi}
\newcommand{\loc}{\mathit{loc}}
\newcommand{\weakto}{\rightharpoonup}
\newcommand{\implied}{\Longleftarrow}
\let\subsetstrict\subset
\renewcommand{\subset}{\subseteq}
\renewcommand{\supset}{\supseteq}

% calligraphic letters
\newcommand{\A}{\mathcal A}
\newcommand{\B}{\mathcal B}
\newcommand{\C}{\mathcal C}
\newcommand{\D}{\mathcal D}
\newcommand{\E}{\mathcal E}
\newcommand{\F}{\mathcal F}
\newcommand{\FL}{\mathcal F\!\mathcal L}
\renewcommand{\H}{\mathcal H}
\newcommand{\K}{\mathcal K}
\renewcommand{\L}{\mathcal L}
\newcommand{\M}{\mathcal M}
\renewcommand{\P}{\mathcal P}
\renewcommand{\S}{\mathcal S}
\newcommand{\U}{\mathcal U} %% intorni

% blackboard letters
\newcommand{\CC}{\mathbb C}
\newcommand{\HH}{\mathbb H}
\newcommand{\KK}{\mathbb K}
\newcommand{\NN}{\mathbb N}
\newcommand{\QQ}{\mathbb Q}
\newcommand{\RR}{\mathbb R}
\newcommand{\TT}{\mathbb T}
\newcommand{\ZZ}{\mathbb Z}

\newcommand{\abs}[1]{{\left|#1\right|}}
\newcommand{\Abs}[1]{{\left\Vert #1\right\Vert}}
\newcommand{\enclose}[1]{{\left( #1 \right)}}
\newcommand{\Enclose}[1]{{\left[ #1 \right]}}
\newcommand{\ENCLOSE}[1]{{\left\{ #1 \right\}}}
\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\ceil}[1]{\left\lceil #1 \right\rceil}

\newcommand{\To}{\rightrightarrows}
\renewcommand{\vec}[1]{\boldsymbol #1}
\newcommand{\defeq}{:=}
\DeclareMathOperator{\divergence}{div}
\renewcommand{\div}{\divergence}
% \DeclareMathOperator{\ker}{ker}  %% already defined
\DeclareMathOperator{\Imaginarypart}{Im}
\renewcommand{\Im}{\Imaginarypart}
\DeclareMathOperator{\Realpart}{Re}
\renewcommand{\Re}{\Realpart}
%\DeclareMathOperator{\arg}{arg}
\DeclareMathOperator{\tg}{tg}
\DeclareMathOperator{\arctg}{arctg}
\DeclareMathOperator{\tgh}{tgh}
\DeclareMathOperator{\settsinh}{settsinh}
\DeclareMathOperator{\settcosh}{settcosh}
\DeclareMathOperator{\setttgh}{setttgh}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\diag}{diag}

\declaretheoremstyle[
spaceabove=6pt, spacebelow=6pt,
headfont=\normalfont\bfseries\itshape,
notefont=\mdseries, notebraces={(}{)},
bodyfont=\normalfont,
postheadspace=1em,
qed=,
%shaded={rulecolor=pink!30,rulewidth=1pt,bgcolor=pink!10}
]{exercise_style}

\declaretheoremstyle[
spaceabove=6pt, spacebelow=6pt,
postheadspace=1em,
qed=,
%shaded={rulecolor=blue!20,rulewidth=1pt,bgcolor=blue!5}
]{theorem_style}

\declaretheoremstyle[
spaceabove=6pt, spacebelow=6pt,
postheadspace=1em,
qed=,
%shaded={rulecolor=yellow!50,rulewidth=1pt,bgcolor=yellow!5}
]{axiom_style}

\numberwithin{equation}{chapter}
\declaretheorem[name=Teorema,numberwithin=chapter]{theorem}
\declaretheorem[name=Lemma,sibling=theorem]{lemma}
\declaretheorem[name=Proposizione,sibling=theorem]{proposition}
\declaretheorem[name=Corollario,sibling=theorem]{corollary}
\declaretheorem[name=Paradosso,sibling=theorem]{paradox}
\declaretheorem[style=axiom_style,name=Assioma,sibling=theorem]{axiom}
\declaretheorem[name=Definizione,sibling=theorem]{definition}
\declaretheorem[style=exercise_style,name=Esempio,sibling=theorem]{example}
\declaretheorem[style=exercise_style,name=Esercizio,sibling=theorem]{exercise}
\declaretheorem[style=exercise_style,name=Osservazione,sibling=theorem]{remark}


%\newtheorem{theorem}{Teorema}[chapter]
%\newtheorem{lemma}[theorem]{Lemma}
%\newtheorem{exercise}[theorem]{Esercizio}
%\newtheorem{proposition}[theorem]{Proposizione}
%\newtheorem{corollary}[theorem]{Corollario}
%\newtheorem{example}[theorem]{Esempio}
%\newtheorem{definition}[theorem]{Definizione}
%\newtheorem{axiom}[theorem]{Assioma}

%% average integral, see https://tex.stackexchange.com/questions/759/average-integral-symbol
\def\Xint#1{\mathchoice
{\XXint\displaystyle\textstyle{#1}}%
{\XXint\textstyle\scriptstyle{#1}}%
{\XXint\scriptstyle\scriptscriptstyle{#1}}%
{\XXint\scriptscriptstyle\scriptscriptstyle{#1}}%
\!\int}
\def\XXint#1#2#3{{\setbox0=\hbox{$#1{#2#3}{\int}$ }
\vcenter{\hbox{$#2#3$ }}\kern-.6\wd0}}
\def\ddashint{\Xint=}
\def\dashint{\Xint-}

\ExplSyntaxOn
\newcommand\stripExclamation[1]{
\def\tmp{#1}
\regex_replace_all:nnN { "! } { 91848243 }\tmp
\regex_replace_all:nnN { ! } { \  }\tmp
\regex_replace_all:nnN { 91848243 } { ! }\tmp
\tmp}
\ExplSyntaxOff

\newcommand{\mymark}[1]{\reversemarginpar\marginnote{#1}\normalmarginpar}

\newcommand{\mynote}[1]{\marginnote{{\footnotesize\stripExclamation{#1}}}}
\newcommand{\mymargin}[1]{\mynote{#1}\index{#1}}
% utilizzo di myemph:
% \myemph[margin note]{emph and index}
\newcommand{\myemph}[2][dummy_not_defined]{%
  \emph{\stripExclamation{#2}}%
  \ifthenelse{\equal{#1}{dummy_not_defined}}%
    {\ifthenelse{\isempty{#2}}{}{\mynote{#2}}%
    \index{#2}}%
    {\mynote{#1}%
    \index{#2}}}%

\newwrite\myauxfile
\immediate\openout\myauxfile=AnalisiUno.myaux
\newcommand{\myaux}[1]{\write\myauxfile{#1}}

% #1 shorten url della pagina: l'url completo va messo in make-docs.sh
% #2 testo HTML da scrivere nel link della documentazione
\newcommand{\myurl}[2]{%
\marginnote{\qrcode[height=1.3cm]{http://paolini.github.io/AnalisiUno?#1}\\%
\scriptsize{(interagisci)}~}%
\write\myauxfile{<!--MYURL--><li><a href="?#1">#2</a> (pagina \thepage, capitolo \thechapter)</li>}%
}
% come \myurl ma con un offset verticale #3
\newcommand{\myurloff}[3]{%
\marginnote{\qrcode[height=1.3cm]{http://paolini.github.io/AnalisiUno?#1}\\%
\scriptsize{(interagisci)}~}[#3]%
\write\myauxfile{<!--MYURL--><li><a href="?#1">#2</a> (pagina \thepage, capitolo \thechapter)</li>}%
}
%
% #1: url della pagina
% #2: testo da scrivere sotto il qrcode
% #3: testo HTML da scrivere nel link della documentazione
%% negli URL i caratteri % vanno sostituiti con \%
\newcommand{\myqrcode}[3]{%
  \marginnote{\qrcode[height=1.7cm]{#1}\\%
  {\footnotesize #2}}%
  \myaux{<!--MYQRCODE--><li><a href="#1">#2 #3</a> (pagina \thepage)</li>}%
  }

\title{Appunti di\\Analisi Matematica Uno\\\mbox{}\\
\qrcode{https://paolini.github.io/AnalisiUno/}%
}
\author{E. Paolini}

\makeindex

%% per compilare un solo capitolo scommenta
%% una delle righe seguenti:
%\includeonly{chapters/AnalisiUno-00-introduzione}
%\includeonly{chapters/AnalisiUno-01-reali}
%\includeonly{chapters/AnalisiUno-02-funzioni}
%\includeonly{chapters/AnalisiUno-02-successioni}
%\includeonly{chapters/AnalisiUno-03-serie}
%\includeonly{chapters/AnalisiUno-04-complessi}
%\includeonly{chapters/AnalisiUno-05-derivate}
%\includeonly{chapters/AnalisiUno-06-integrali}
%\includeonly{chapters/AnalisiUno-07-spazi}
%\includeonly{chapters/AnalisiUno-08-ricorrenza}
%\includeonly{chapters/AnalisiUno-09-edo}
%\includeonly{chapters/AnalisiUno-98-algebra}

\begin{document}
\maketitle
\mbox{}
\thispagestyle{empty}
\vfill
\doclicenseThis

\frontmatter

\include{chapters/AnalisiUno-00-introduzione}

\tableofcontents

\mainmatter

\include{chapters/AnalisiUno-01-reali}

%\include{chapters/AnalisiUno-02-funzioni}

\include{chapters/AnalisiUno-02-successioni}

\include{chapters/AnalisiUno-03-serie}

\include{chapters/AnalisiUno-04-complessi}

\include{chapters/AnalisiUno-05-derivate}

\include{chapters/AnalisiUno-06-integrali}

\include{chapters/AnalisiUno-07-spazi}

\include{chapters/AnalisiUno-08-ricorrenza}

\include{chapters/AnalisiUno-09-edo}

\backmatter

%\include{chapters/AnalisiUno-98-algebra}
\include{chapters/AnalisiUno-99-appendix}

\nocite{Giusti}
\nocite{Courant}
\nocite{Marcellini}
\nocite{Rudin}
\nocite{PaganiSalsa}
\nocite{appunti_logica}

\bibliographystyle{plain}
\bibliography{biblio}

\printindex

\end{document}
